<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">
	<link rel='shortcut icon' type='image/png' href='/DyCon-Blog/favicon.png' />

  <title>
    Control for a semilinear heat equation and analogies with a collective behavior model - DyCon Blog
    
  </title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="canonical" href="https://deustotech.github.io/DyCon-Blog/tutorial/wp06/P0008">

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/clean-blog.css">

   <!-- Adjust Colors -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/colorscheme.css">

  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/syntax.css">

  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/google-search.css">


  
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/libgif.js "></script>
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/rubbable.js "></script>


  <!-- Google Fonts Raleway -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
	<!-- MathJax -->
  <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      },
      extensions: ["AMSmath.js", "AMSsymbols.js"],
      Macros:{
        norm: ["|| #1 ||",1],
        abs: ["| #1 |",1],
        hdots: "...",
        RR: "\\mathbb{R}",
        ffl: ["(d_x^2)^{#1}",1],
        ccs: "c_{1,s}",
        kernel: ["|x-y|^{#1}",1],
        ue: ["#1^{\\epsilon}",1]
      }
    },
    CommonHTML: {
      styles: {
        "@font-face /* vec */ ": {
          "font-family": "MJX-VEC",
          src: [
            "url(data:application/x-font-woff;charset=utf-8;base64,",
            "d09GRgABAAAAAARMAA0AAAAABiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEMAAAABwA",
            "AAAccRGLqUdERUYAAAQMAAAAJAAAACgANAAmT1MvMgAAAaAAAABJAAAAYFc5gfFjbWFwAAACAAAA",
            "AEYAAAFKQxjlbWdhc3AAAAQEAAAACAAAAAj//wADZ2x5ZgAAAlQAAACUAAAAlIQU9HBoZWFkAAAB",
            "MAAAADAAAAA2C748e2hoZWEAAAFgAAAAHgAAACQFXQDqaG10eAAAAewAAAAUAAAAFAYvAE9sb2Nh",
            "AAACSAAAAAwAAAAMACgAcm1heHAAAAGAAAAAHQAAACAASQAmbmFtZQAAAugAAADxAAAB5uwlD0hw",
            "b3N0AAAD3AAAACgAAAA34M9aEXjaY2BkYGAA4uOfgq7G89t8ZeBmfgEUYbga+icNTssClVxnOgXk",
            "cjAwgUQBdqEMW3jaY2BkYGBu+feBgYHxCwMQMF5nYGRABawAcaQESgAAeNpjYGRgYGBlUGZgYgAB",
            "EMnIABJzAPMZAAZZAHAAAAB42mNgYSxn/MLAysDA1MW0h4GBoQdCMz5gMGRkAooysDEzwAAjECvA",
            "OAFprikMBxgUFCcxt/z7wMDA3MIoAFUDAwoMjACD8Qv5AAAAAfQAMgAAAAABTQAAAPoAAAH0AB14",
            "2mNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYFBQn/f8P5IPp/4/vFUHVAwEjGwOcw8gEJJgY",
            "UAEjxIrhDACLGwmnAAAAAAAUABQAFAAUAEoAAgAyAAABwgIVAAMABwAAMxEhESUhESEyAZD+ogEs",
            "/tQCFf3rMgGxAAEAHQIEAdcCygAiAAABNDYzMhcWFxYXFhUUBgcGBw4DIyImNTQ3IycmNTQ3ISYB",
            "eQsJBwUFBQofCwYLKyACBwMGBAcNL6urDQ0BZxgCtggMBQQPJRQHCwkGBhYpAgkCAgsJEygBCQoH",
            "DSYAeNqVjrGKwkAURe/EGBBUrG12CishMrFQcDuLsAi26YMOmsIMxAh+hN8i+CF+gd+y4B3zttjC",
            "woHhncu7774HoI8rFP5eIKzQw5dwgAjfwi2McBEO6bkLtzHAr3CEnhrTqcKOpDasMCQ1HKCLWLiF",
            "HyyFQ3puwm1oPIQjDFXfR62Ro8YeK9YzMlhsqB0qtvJ6v8rPmd3Uzkv2tihwwoHCbosTa0pryYH0",
            "NbKjRWPB/z626Se8dsY/hSHPGeTKOnXVzuqF/reYOoln8dQk80+u9b0KR97rD9Rc4xdNXtVQI7PV",
            "sXClNiaZGGP0B+FPMN1KMAAAAHjaY2BiAIP/zQxGDNgAKxAzMjAxMDMycSUWFeWXF2WmZ5QAAGh5",
            "BhgAAAAB//8AAnjaY2BkYGDgA2IJBgUgycTAyMDMwAIkWcA8BgZGCAYACgIAWwAAAAEAAAAAxmW3",
            "ygAAAADVVeemAAAAANVV7Dg=) format('woff')"
          ].join('')
        },
        ".MJX-VEC": {
          "font-family": "MJX-VEC"
        }
      }
    }
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
  <script src="https://deustotech.github.io/DyCon-Blog/js/clean-blog.min.js "></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128123935-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128123935-3');
  </script>
  <!-- End Google Analytics -->



  <!-- marKdown editor -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
  <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
</head>

<body>
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/DyCon-Blog/">
                 <img src="https://deustotech.github.io//DyCon-Blog//assets/logo_DyCon.png">
            </a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/DyCon-Blog/">Home</a>
                </li>
                
                
                    
                        
                    
                                   
                <li>
                    <a href="/DyCon-Blog/projects/posts">Documentation</a>
                </li>
                
                    
                
                    
                <li>
                        <a href="https://deustotech.github.io/DyCon-Blog/projects/search.byWP">Sitemap</a>
                </li>
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
                
            </ul>

        
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Post Header -->
<header class="intro-header">
  <div class="container" style="padding-top: 70px;">
    <div class="row">
      <div class="col-lg-10 col-md-10 col-md-offset-1">
        <div class="post-heading" style="padding: 0px 0"><h2><small class="light-grey"><a href="https://deustotech.github.io//DyCon-Blog/projects/posts">Work Packages</a>
            &#8827;<a href="https://deustotech.github.io//DyCon-Blog/workpackage/WP06">
            Finite versus infinite-dimensional dynamical systems</a> &#8827;</small>
          </h2>
          <h1>Control for a semilinear heat equation and analogies with a collective behavior model</h1>
					<p class="meta">
            <div class="post-preview-authors ellipsis-one-line">
              Author:
              
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/DomenecR">Domenec Ruiz</a>
                  </span>
                </span>
              
              - 15 March 2020
            </div>
					</p>
        </div>
      </div>
		</div>
	</div>
</header>
<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>
<article>
  <div id="content" class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          
            <a href="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP06/P0008/T0005_ControlOfSemiLinearHeatEquation.zip""><i class="fa fa-download fa-lg"></i>Download Code</a>
          
        
        <p>In this tutorial we will apply the DyCon toolbox to find a control to the semi-discrete semi-linear heat equation.</p>

<script type="math/tex; mode=display">y_t-N^2Ay=G(y)+Bu</script>

<p>where $N^2A$ is the discretization of the Laplacian in 1d in $N$ nodes. We are looking for a control that after time $T$ steers the system near zero.</p>

<h3 id="setup">Setup</h3>

<p>In this tutorial we need <a href="https://deustotech.github.io/dycon-toolbox-documentation/">DyCon Toolbox</a>, to install it we will have to write the following in our MATLAB console:</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">unzip</span><span class="p">(</span><span class="s1">'https://github.com/DeustoTech/DyCon-Computational-Platform/archive/master.zip'</span><span class="p">)</span>
<span class="nb">addpath</span><span class="p">(</span><span class="nb">genpath</span><span class="p">(</span><span class="nb">fullfile</span><span class="p">(</span><span class="nb">cd</span><span class="p">,</span><span class="s1">'DyCon-toolbox-master'</span><span class="p">)))</span>
</code></pre>
</div>
<h3 id="methodology">Methodology</h3>
<p>In order to do so we will frame the problem as a minimization of a functional and we will apply gradient descent to find it. Note that the convexity of the functional is not proven, therefore, we will obtain a local minima for the functional. The functional considered will be:</p>

<script type="math/tex; mode=display">J(\boldsymbol{y},\boldsymbol{u})= | \boldsymbol{y}(t) |_{L^2}^2+\int_0^T | \boldsymbol{u}(t) |_{L^2}^2 dt</script>

<p>where by $| \cdot |_{L^2}$ we understand the discrete $L^2$ norm.</p>

<p>Once this control is computed for a certain N, we will think on a dynamical system that models an opinion dynamics with $N$ agents communicating through a chain.</p>

<p>\begin{equation}\label{m1}y_t-\frac{1}{N}Ay=G(y)+Bv\end{equation}</p>

<p>The goal will be to compute also the control $v$ thinking model \eqref{m1} as if it was a semidiscretization of a heat equation with diffusivity $\frac{1}{N^3}$. Furthermore we will also compute the control for model \eqref{m1} with the non-linearity being non-homogeneous on $N$ and a time horizon being $T_N=N^3T$.</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">clear</span> <span class="nb">all</span>
<span class="nb">import</span> <span class="n">casadi</span><span class="o">.*</span>
</code></pre>
</div>

<p>Definition of the time</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">ts</span> <span class="o">=</span> <span class="n">SX</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s1">'t'</span><span class="p">);</span>
<span class="c1">%% Discretization of the space</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="n">xi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">xf</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">xline</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span><span class="n">xf</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
</code></pre>
</div>

<p>Interior Control region between 0.5 and 0.8</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">w1</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">w2</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">;</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">GetABmatrix</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">D</span><span class="p">);</span>
</code></pre>
</div>

<p>we define symbolically the vectors of the state and the control</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">Ys</span> <span class="o">=</span> <span class="n">SX</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,[</span><span class="n">N</span> <span class="mi">1</span><span class="p">]);</span>
<span class="n">Us</span> <span class="o">=</span> <span class="n">SX</span><span class="o">.</span><span class="n">sym</span><span class="p">(</span><span class="s1">'u'</span><span class="p">,[</span><span class="n">count</span> <span class="mi">1</span><span class="p">]);</span>
</code></pre>
</div>

<p>We create the ODE object Our ODE object will have the semi-discretization of the semilinear heat equation. We set also initial conditions, define the non linearity and the interaction of the control to the dynamics.</p>

<p>Initial condition</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">Y0</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="nb">pi</span><span class="o">*</span><span class="n">xline</span><span class="o">'</span><span class="p">);</span>
</code></pre>
</div>

<p>Diffusion part: the discretization of the 1d Laplacian</p>

<p>Definition of the non-linearity <script type="math/tex">\partial_y[-5\exp(-y^2)]</script></p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">G</span> <span class="o">=</span> <span class="n">casadi</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">'NLT'</span><span class="p">,{</span><span class="n">Ys</span><span class="p">},{</span><span class="mi">10</span><span class="o">*</span><span class="n">Ys</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ys</span><span class="o">.^</span><span class="mi">2</span><span class="p">)});</span><span class="c1">%%</span>
</code></pre>
</div>

<p>and we define the part of the dynamics corresponding to the nonlinearity</p>

<p>Putting all the things together</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">F</span> <span class="o">=</span> <span class="n">casadi</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">'F'</span><span class="p">,{</span><span class="n">ts</span><span class="p">,</span><span class="n">Ys</span><span class="p">,</span><span class="n">Us</span><span class="p">},{</span><span class="n">A</span><span class="o">*</span><span class="n">Ys</span> <span class="o">+</span> <span class="n">B</span><span class="o">*</span><span class="n">Us</span> <span class="o">+</span> <span class="n">G</span><span class="p">(</span><span class="n">Ys</span><span class="p">)});</span>
<span class="c1">%% Creation of the ODE object</span>
<span class="c1">%% Time horizon</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre>
</div>

<p>We create the ODE-object and we change the resolution to $dt=0.01$ in order to see the variation in a small time scale. We will get the values of the solution in steps of size odeEqn.dt, if we do not care about modifying this parameter in the object, we might get the solution in certain time steps that will hide part of the dynamics.</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">Nt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Nt</span><span class="p">);</span>
<span class="n">ipde</span> <span class="o">=</span> <span class="n">semilinearpde1d</span><span class="p">(</span><span class="n">Ys</span><span class="p">,</span><span class="n">Us</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">xline</span><span class="p">);</span>
<span class="n">ipde</span><span class="o">.</span><span class="n">InitialCondition</span> <span class="o">=</span> <span class="n">Y0</span><span class="p">;</span>
</code></pre>
</div>

<p>We solve the equation and we plot the free solution applying solve to odeEqn and we plot the free solution.</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">Yfree</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">ipde</span><span class="p">,</span><span class="n">ZerosControl</span><span class="p">(</span><span class="n">ipde</span><span class="p">));</span>
<span class="n">Yfree</span> <span class="o">=</span> <span class="nb">full</span><span class="p">(</span><span class="n">Yfree</span><span class="p">);</span>
</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">figure</span><span class="p">;</span>
<span class="nb">surf</span><span class="p">(</span><span class="n">Yfree</span><span class="s1">','</span><span class="n">EdgeColor</span><span class="s1">','</span><span class="n">none</span><span class="o">'</span><span class="p">);</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'Free Dynamics'</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'space discretization'</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s1">'Time'</span><span class="p">)</span>
<span class="n">yticks</span><span class="p">([</span><span class="mi">1</span> <span class="n">Nt</span><span class="p">])</span>
<span class="n">yticklabels</span><span class="p">([</span><span class="n">tspan</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">tspan</span><span class="p">(</span><span class="k">end</span><span class="p">)])</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_01.png" alt="" /></p>

<p>We create the object that collects the formulation of an optimal control problem  by means of the object that describes the dynamics odeEqn, the functional to minimize Jfun and the time horizon T</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">L</span>   <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">'L'</span>  <span class="p">,{</span><span class="n">ts</span><span class="p">,</span><span class="n">Ys</span><span class="p">,</span><span class="n">Us</span><span class="p">},{</span> <span class="n">Us</span><span class="o">.'*</span><span class="n">Us</span>  <span class="p">});</span>
<span class="n">Psi</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="s1">'Psi'</span><span class="p">,{</span><span class="n">Ys</span><span class="p">}</span>      <span class="p">,{</span> <span class="mf">1e6</span><span class="o">*</span><span class="p">(</span><span class="n">Ys</span><span class="o">.'*</span><span class="n">Ys</span><span class="p">)</span> <span class="p">});</span>

<span class="n">iocp</span> <span class="o">=</span> <span class="n">ocp</span><span class="p">(</span><span class="n">ipde</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">Psi</span><span class="p">);</span>
</code></pre>
</div>

<p>We apply the steepest descent method to obtain a local minimum (our functional might not be convex).</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">U0</span> <span class="o">=</span><span class="n">ZerosControl</span><span class="p">(</span><span class="n">ipde</span><span class="p">);</span>
<span class="p">[</span><span class="n">OptControl</span> <span class="p">,</span><span class="n">OptState</span><span class="p">]</span>  <span class="o">=</span> <span class="n">IpoptSolver</span><span class="p">(</span><span class="n">iocp</span><span class="p">,</span><span class="n">U0</span><span class="p">);</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>This is Ipopt version 3.12.3, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Number of nonzeros in equality constraint Jacobian...:    19236
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:     3900

Total number of variables............................:     3900
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:     3000
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  3.0000000e+07 9.05e+00 9.67e-01  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0
   1  2.4544321e+05 1.22e-01 7.92e+00  -1.0 3.10e+01  -2.0 1.00e+00 1.00e+00f  1
   2  1.8219937e+06 4.24e-03 1.73e+00  -1.0 1.31e+01  -1.6 1.00e+00 1.00e+00h  1
   3  7.1220860e+04 1.67e-02 2.92e+00  -1.0 9.12e+00  -2.1 1.00e+00 1.00e+00f  1
   4  8.9356500e+03 3.97e-04 8.51e-02  -1.0 2.41e+00  -2.5 1.00e+00 1.00e+00f  1
   5  3.1075917e+03 1.06e-04 3.19e-03  -2.5 2.96e+00  -3.0 1.00e+00 1.00e+00f  1
   6  1.3016546e+03 5.20e-05 1.19e-03  -3.8 3.60e+00  -3.5 1.00e+00 1.00e+00h  1
   7  4.5871538e+02 5.64e-05 4.84e-04  -5.7 4.41e+00  -4.0 1.00e+00 1.00e+00h  1
   8  1.6346578e+02 6.55e-05 1.92e-04  -5.7 5.26e+00  -4.4 1.00e+00 1.00e+00h  1
   9  9.7049320e+01 1.20e-04 3.78e-05  -5.7 3.10e+00  -4.9 1.00e+00 1.00e+00h  1
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
  10  4.0069187e+01 9.26e-03 1.98e-05  -5.7 1.48e+01    -  1.00e+00 5.00e-01h  2
  11  1.6748754e+01 4.28e-04 2.92e-06  -5.7 4.34e+00    -  1.00e+00 1.00e+00h  1
  12  1.6371256e+01 4.58e-06 9.87e-09  -5.7 1.88e-01    -  1.00e+00 1.00e+00h  1
  13  1.6367177e+01 1.03e-11 1.11e-13  -8.6 7.84e-04    -  1.00e+00 1.00e+00h  1

Number of Iterations....: 13

                                   (scaled)                 (unscaled)
Objective...............:   8.1835886066017175e-04    1.6367177213203433e+01
Dual infeasibility......:   1.1096830919432588e-13    2.2193661838865175e-09
Constraint violation....:   1.0345974077452524e-11    1.0345974077452524e-11
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   1.0345974077452524e-11    2.2193661838865175e-09


Number of objective function evaluations             = 19
Number of objective gradient evaluations             = 14
Number of equality constraint evaluations            = 19
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 14
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 13
Total CPU secs in IPOPT (w/o function evaluations)   =      0.436
Total CPU secs in NLP function evaluations           =      0.057

EXIT: Optimal Solution Found.
               t_proc [s]   t_wall [s]    n_eval
       nlp_f     0.000826     0.000828        19
       nlp_g      0.00916      0.00917        19
  nlp_grad_f      0.00139      0.00139        15
  nlp_hess_l       0.0175       0.0174        13
   nlp_jac_g       0.0333       0.0333        15
      solver        0.507        0.501         1
Elapsed time is 0.636870 seconds.

</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">plotSHE</span><span class="p">(</span><span class="n">OptState</span><span class="p">,</span><span class="n">OptControl</span><span class="p">,</span><span class="n">Yfree</span><span class="p">,</span><span class="n">YT</span><span class="p">,</span><span class="n">xline</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">Nt</span><span class="p">)</span>
</code></pre>
</div>

<table>
    <tr>
        <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_02.png" />
        </th>
         <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_03.png" />
        </th>       
    </tr>
</table>

<h3 id="collective-behavior-dynamics">Collective behavior dynamics</h3>

<p>Now we apply the same procedure for the collective behavior dynamics. We will employ a function that does the algorithm explained before for the semilinear heat equation having the chance to set a diffusivity constant.</p>

<p>For the simulation of the model in collective behavior we will employ a diffusivity $D=\frac{1}{N^3}$.</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">D</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/(</span><span class="n">N</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">GetABmatrix</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">D</span><span class="p">);</span>
<span class="c1">%%</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">casadi</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">'NLT'</span><span class="p">,{</span><span class="n">Ys</span><span class="p">},{</span><span class="mi">10</span><span class="o">*</span><span class="n">Ys</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ys</span><span class="o">.^</span><span class="mi">2</span><span class="p">)});</span><span class="c1">%%</span>
<span class="c1">%%</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="n">Nt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Nt</span><span class="p">);</span>
<span class="c1">%%</span>
<span class="n">ipde</span> <span class="o">=</span> <span class="n">semilinearpde1d</span><span class="p">(</span><span class="n">Ys</span><span class="p">,</span><span class="n">Us</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">xline</span><span class="p">);</span>
<span class="n">ipde</span><span class="o">.</span><span class="n">InitialCondition</span> <span class="o">=</span> <span class="n">Y0</span><span class="p">;</span>
<span class="c1">%%</span>
<span class="n">iocp</span> <span class="o">=</span> <span class="n">ocp</span><span class="p">(</span><span class="n">ipde</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">Psi</span><span class="p">);</span>
</code></pre>
</div>

<table>
    <tr>
        <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_05.png" />
        </th>
         <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_06.png" />
        </th>       
    </tr>
</table>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">U0</span> <span class="o">=</span><span class="n">ZerosControl</span><span class="p">(</span><span class="n">ipde</span><span class="p">);</span>
<span class="c1">%%[OptControl ,OptState]  = ArmijoGradient(iocp,U0,'MaxIter',200);</span>
<span class="p">[</span><span class="n">OptControl</span> <span class="p">,</span><span class="n">OptState</span><span class="p">]</span>  <span class="o">=</span> <span class="n">IpoptSolver</span><span class="p">(</span><span class="n">iocp</span><span class="p">,</span><span class="n">U0</span><span class="p">);</span>
</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">This</span> <span class="nb">is</span> <span class="n">Ipopt</span> <span class="nb">version</span> <span class="mf">3.12</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">running</span> <span class="n">with</span> <span class="n">linear</span> <span class="n">solver</span> <span class="n">mumps</span><span class="o">.</span>
<span class="n">NOTE</span><span class="p">:</span> <span class="n">Other</span> <span class="n">linear</span> <span class="n">solvers</span> <span class="n">might</span> <span class="n">be</span> <span class="nb">more</span> <span class="n">efficient</span> <span class="p">(</span><span class="n">see</span> <span class="n">Ipopt</span> <span class="n">documentation</span><span class="p">)</span><span class="o">.</span>

<span class="n">Number</span> <span class="n">of</span> <span class="nb">nonzeros</span> <span class="n">in</span> <span class="n">equality</span> <span class="n">constraint</span> <span class="n">Jacobian</span><span class="k">...</span><span class="c">:    19236</span>
<span class="n">Number</span> <span class="n">of</span> <span class="nb">nonzeros</span> <span class="n">in</span> <span class="n">inequality</span> <span class="n">constraint</span> <span class="n">Jacobian</span><span class="o">.</span><span class="p">:</span>        <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="nb">nonzeros</span> <span class="n">in</span> <span class="n">Lagrangian</span> <span class="n">Hessian</span><span class="k">...</span><span class="c">..........:     3900</span>

<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">variables</span><span class="k">...</span><span class="c">.........................:     3900</span>
                     <span class="n">variables</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">lower</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
                <span class="n">variables</span> <span class="n">with</span> <span class="nb">lower</span> <span class="nb">and</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
                     <span class="n">variables</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraints</span><span class="k">...</span><span class="c">..............:     3000</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">inequality</span> <span class="n">constraints</span><span class="k">...</span><span class="c">............:        0</span>
        <span class="n">inequality</span> <span class="n">constraints</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">lower</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
   <span class="n">inequality</span> <span class="n">constraints</span> <span class="n">with</span> <span class="nb">lower</span> <span class="nb">and</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
        <span class="n">inequality</span> <span class="n">constraints</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>

<span class="n">iter</span>    <span class="n">objective</span>    <span class="n">inf_pr</span>   <span class="n">inf_du</span> <span class="n">lg</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>  <span class="o">||</span><span class="n">d</span><span class="o">||</span>  <span class="n">lg</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span> <span class="n">alpha_du</span> <span class="n">alpha_pr</span>  <span class="nb">ls</span>
   <span class="mi">0</span>  <span class="mf">3.0000000e+07</span> <span class="mf">1.00e+00</span> <span class="mf">9.72e-01</span>  <span class="o">-</span><span class="mf">1.0</span> <span class="mf">0.00e+00</span>    <span class="o">-</span>  <span class="mf">0.00e+00</span> <span class="mf">0.00e+00</span>   <span class="mi">0</span>
   <span class="mi">1</span>  <span class="mf">1.1211823e+08</span> <span class="mf">6.93e-02</span> <span class="mf">1.07e+01</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">1.75e+00</span>   <span class="mf">0.0</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">2</span>  <span class="mf">1.0201471e+08</span> <span class="mf">2.53e-02</span> <span class="mf">2.23e+00</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">3.50e+00</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">3</span>  <span class="mf">8.8642262e+07</span> <span class="mf">4.18e-02</span> <span class="mf">5.31e-01</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">2.13e+02</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">4</span>  <span class="mf">8.2505158e+07</span> <span class="mf">1.39e+00</span> <span class="mf">3.13e+00</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">2.72e+03</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">F</span>  <span class="mi">1</span>
   <span class="mi">5</span>  <span class="mf">7.9212105e+07</span> <span class="mf">9.68e+00</span> <span class="mf">5.20e+00</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">1.38e+03</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">6</span>  <span class="mf">7.8291279e+07</span> <span class="mf">6.94e-02</span> <span class="mf">2.84e+00</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">2.05e+03</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">7</span>  <span class="mf">7.8090072e+07</span> <span class="mf">1.57e+00</span> <span class="mf">4.98e-01</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">7.87e+02</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">8</span>  <span class="mf">7.8026943e+07</span> <span class="mf">1.54e-01</span> <span class="mf">8.25e-02</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">3.33e+02</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">9</span>  <span class="mf">7.8491521e+07</span> <span class="mf">4.41e-02</span> <span class="mf">7.64e+00</span>  <span class="o">-</span><span class="mf">2.5</span> <span class="mf">2.10e+00</span>  <span class="o">-</span><span class="mf">1.0</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
<span class="n">iter</span>    <span class="n">objective</span>    <span class="n">inf_pr</span>   <span class="n">inf_du</span> <span class="n">lg</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>  <span class="o">||</span><span class="n">d</span><span class="o">||</span>  <span class="n">lg</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span> <span class="n">alpha_du</span> <span class="n">alpha_pr</span>  <span class="nb">ls</span>
<span class="k">...</span>
<span class="k">...</span>
  <span class="mi">54</span>  <span class="mf">7.8022238e+07</span> <span class="mf">4.03e-07</span> <span class="mf">8.33e-10</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">2.15e-02</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
  <span class="mi">55</span>  <span class="mf">7.8022238e+07</span> <span class="mf">9.83e-12</span> <span class="mf">1.82e-12</span>  <span class="o">-</span><span class="mf">8.6</span> <span class="mf">1.02e-04</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>

<span class="n">Number</span> <span class="n">of</span> <span class="n">Iterations</span><span class="k">...</span><span class="c">.: 55</span>

                                   <span class="p">(</span><span class="n">scaled</span><span class="p">)</span>                 <span class="p">(</span><span class="n">unscaled</span><span class="p">)</span>
<span class="n">Objective</span><span class="k">...</span><span class="c">............:   3.9011119130960064e+03    7.8022238261920124e+07</span>
<span class="n">Dual</span> <span class="n">infeasibility</span><span class="k">...</span><span class="c">...:   1.8189894035458565e-12    3.6379788070917130e-08</span>
<span class="n">Constraint</span> <span class="n">violation</span><span class="k">...</span><span class="c">.:   9.8296371042749797e-12    9.8296371042749797e-12</span>
<span class="n">Complementarity</span><span class="k">...</span><span class="c">......:   0.0000000000000000e+00    0.0000000000000000e+00</span>
<span class="n">Overall</span> <span class="n">NLP</span> <span class="nb">error</span><span class="k">...</span><span class="c">....:   9.8296371042749797e-12    3.6379788070917130e-08</span>


<span class="n">Number</span> <span class="n">of</span> <span class="n">objective</span> <span class="k">function</span> <span class="n">evaluations</span>             <span class="o">=</span> <span class="mi">111</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">objective</span> <span class="nb">gradient</span> <span class="n">evaluations</span>             <span class="o">=</span> <span class="mi">56</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraint</span> <span class="n">evaluations</span>            <span class="o">=</span> <span class="mi">111</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">inequality</span> <span class="n">constraint</span> <span class="n">evaluations</span>          <span class="o">=</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraint</span> <span class="n">Jacobian</span> <span class="n">evaluations</span>   <span class="o">=</span> <span class="mi">56</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">inequality</span> <span class="n">constraint</span> <span class="n">Jacobian</span> <span class="n">evaluations</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">Lagrangian</span> <span class="n">Hessian</span> <span class="n">evaluations</span>             <span class="o">=</span> <span class="mi">55</span>
<span class="n">Total</span> <span class="n">CPU</span> <span class="n">secs</span> <span class="n">in</span> <span class="n">IPOPT</span> <span class="p">(</span><span class="n">w</span><span class="p">/</span><span class="n">o</span> <span class="k">function</span> <span class="n">evaluations</span><span class="p">)</span>   <span class="o">=</span>      <span class="mf">1.374</span>
<span class="n">Total</span> <span class="n">CPU</span> <span class="n">secs</span> <span class="n">in</span> <span class="n">NLP</span> <span class="k">function</span> <span class="n">evaluations</span>           <span class="o">=</span>      <span class="mf">0.308</span>

<span class="n">EXIT</span><span class="p">:</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
               <span class="n">t_proc</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>   <span class="n">t_wall</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>    <span class="n">n_eval</span>
       <span class="n">nlp_f</span>      <span class="mf">0.00624</span>      <span class="mf">0.00627</span>       <span class="mi">111</span>
       <span class="n">nlp_g</span>       <span class="mf">0.0634</span>       <span class="mf">0.0633</span>       <span class="mi">111</span>
  <span class="n">nlp_grad_f</span>      <span class="mf">0.00762</span>      <span class="mf">0.00768</span>        <span class="mi">57</span>
  <span class="n">nlp_hess_l</span>       <span class="mf">0.0868</span>       <span class="mf">0.0846</span>        <span class="mi">55</span>
   <span class="n">nlp_jac_g</span>        <span class="mf">0.149</span>        <span class="mf">0.149</span>        <span class="mi">57</span>
      <span class="n">solver</span>         <span class="mf">1.74</span>         <span class="mf">1.73</span>         <span class="mi">1</span>
<span class="n">Elapsed</span> <span class="n">time</span> <span class="nb">is</span> <span class="mf">1.874814</span> <span class="n">seconds</span><span class="o">.</span>

</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">plotSHE</span><span class="p">(</span><span class="n">OptState</span><span class="p">,</span><span class="n">OptControl</span><span class="p">,</span><span class="n">Yfree</span><span class="p">,</span><span class="n">YT</span><span class="p">,</span><span class="n">xline</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">Nt</span><span class="p">)</span>
</code></pre>
</div>

<table>
    <tr>
        <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_07.png" />
        </th>
         <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_08.png" />
        </th>       
    </tr>
</table>

<p>Now we will change also the time horizon and we will incorporate a non-homogeneous non-linearity, we will just divide the non-linearity $G$ by $N^3$</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">D</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/(</span><span class="n">N</span><span class="o">^</span><span class="mi">2</span><span class="p">);</span>
<span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">GetABmatrix</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">w1</span><span class="p">,</span><span class="n">w2</span><span class="p">,</span><span class="n">D</span><span class="p">);</span>
<span class="c1">%%</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">casadi</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">'NLT'</span><span class="p">,{</span><span class="n">Ys</span><span class="p">},{</span><span class="mi">10</span><span class="o">*</span><span class="n">Ys</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ys</span><span class="o">.^</span><span class="mi">2</span><span class="p">)/</span><span class="n">N</span><span class="o">^</span><span class="mi">2</span><span class="p">}</span> <span class="p">);</span><span class="c1">%%</span>
<span class="c1">%%</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">N</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span>  <span class="n">Nt</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">tspan</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">Nt</span><span class="p">);</span>
<span class="c1">%%</span>
<span class="n">ipde</span> <span class="o">=</span> <span class="n">semilinearpde1d</span><span class="p">(</span><span class="n">Ys</span><span class="p">,</span><span class="n">Us</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">xline</span><span class="p">);</span>
<span class="n">ipde</span><span class="o">.</span><span class="n">InitialCondition</span> <span class="o">=</span> <span class="n">Y0</span><span class="p">;</span>
<span class="c1">%%</span>
<span class="n">iocp</span> <span class="o">=</span> <span class="n">ocp</span><span class="p">(</span><span class="n">ipde</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">Psi</span><span class="p">);</span>
</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">U0</span> <span class="o">=</span><span class="n">ZerosControl</span><span class="p">(</span><span class="n">ipde</span><span class="p">);</span>
<span class="p">[</span><span class="n">OptControl</span> <span class="p">,</span><span class="n">OptState</span><span class="p">]</span>  <span class="o">=</span> <span class="n">IpoptSolver</span><span class="p">(</span><span class="n">iocp</span><span class="p">,</span><span class="n">U0</span><span class="p">);</span>
</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">This</span> <span class="nb">is</span> <span class="n">Ipopt</span> <span class="nb">version</span> <span class="mf">3.12</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">running</span> <span class="n">with</span> <span class="n">linear</span> <span class="n">solver</span> <span class="n">mumps</span><span class="o">.</span>
<span class="n">NOTE</span><span class="p">:</span> <span class="n">Other</span> <span class="n">linear</span> <span class="n">solvers</span> <span class="n">might</span> <span class="n">be</span> <span class="nb">more</span> <span class="n">efficient</span> <span class="p">(</span><span class="n">see</span> <span class="n">Ipopt</span> <span class="n">documentation</span><span class="p">)</span><span class="o">.</span>

<span class="n">Number</span> <span class="n">of</span> <span class="nb">nonzeros</span> <span class="n">in</span> <span class="n">equality</span> <span class="n">constraint</span> <span class="n">Jacobian</span><span class="k">...</span><span class="c">:    19236</span>
<span class="n">Number</span> <span class="n">of</span> <span class="nb">nonzeros</span> <span class="n">in</span> <span class="n">inequality</span> <span class="n">constraint</span> <span class="n">Jacobian</span><span class="o">.</span><span class="p">:</span>        <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="nb">nonzeros</span> <span class="n">in</span> <span class="n">Lagrangian</span> <span class="n">Hessian</span><span class="k">...</span><span class="c">..........:     3900</span>

<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">variables</span><span class="k">...</span><span class="c">.........................:     3900</span>
                     <span class="n">variables</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">lower</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
                <span class="n">variables</span> <span class="n">with</span> <span class="nb">lower</span> <span class="nb">and</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
                     <span class="n">variables</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraints</span><span class="k">...</span><span class="c">..............:     3000</span>
<span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">inequality</span> <span class="n">constraints</span><span class="k">...</span><span class="c">............:        0</span>
        <span class="n">inequality</span> <span class="n">constraints</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">lower</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
   <span class="n">inequality</span> <span class="n">constraints</span> <span class="n">with</span> <span class="nb">lower</span> <span class="nb">and</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>
        <span class="n">inequality</span> <span class="n">constraints</span> <span class="n">with</span> <span class="n">only</span> <span class="nb">upper</span> <span class="n">bounds</span><span class="p">:</span>        <span class="mi">0</span>

<span class="n">iter</span>    <span class="n">objective</span>    <span class="n">inf_pr</span>   <span class="n">inf_du</span> <span class="n">lg</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>  <span class="o">||</span><span class="n">d</span><span class="o">||</span>  <span class="n">lg</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span> <span class="n">alpha_du</span> <span class="n">alpha_pr</span>  <span class="nb">ls</span>
   <span class="mi">0</span>  <span class="mf">3.0000000e+07</span> <span class="mf">9.05e+00</span> <span class="mf">1.17e+02</span>  <span class="o">-</span><span class="mf">1.0</span> <span class="mf">0.00e+00</span>    <span class="o">-</span>  <span class="mf">0.00e+00</span> <span class="mf">0.00e+00</span>   <span class="mi">0</span>
   <span class="mi">1</span>  <span class="mf">2.8754020e+04</span> <span class="mf">1.48e-01</span> <span class="mf">4.01e+00</span>  <span class="o">-</span><span class="mf">1.0</span> <span class="mf">2.73e+00</span>   <span class="mf">0.0</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">f</span>  <span class="mi">1</span>
   <span class="mi">2</span>  <span class="mf">3.0839145e+03</span> <span class="mf">1.91e-02</span> <span class="mf">3.08e-01</span>  <span class="o">-</span><span class="mf">1.0</span> <span class="mf">9.19e-01</span>  <span class="o">-</span><span class="mf">0.5</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">3</span>  <span class="mf">9.2703794e+02</span> <span class="mf">1.17e-03</span> <span class="mf">2.31e-02</span>  <span class="o">-</span><span class="mf">1.7</span> <span class="mf">2.08e-01</span>  <span class="o">-</span><span class="mf">1.0</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">4</span>  <span class="mf">4.2707593e+02</span> <span class="mf">2.49e-03</span> <span class="mf">9.65e-03</span>  <span class="o">-</span><span class="mf">3.8</span> <span class="mf">2.61e-01</span>  <span class="o">-</span><span class="mf">1.4</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">5</span>  <span class="mf">2.2851845e+02</span> <span class="mf">1.36e-03</span> <span class="mf">2.60e-03</span>  <span class="o">-</span><span class="mf">3.8</span> <span class="mf">2.10e-01</span>  <span class="o">-</span><span class="mf">1.9</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">6</span>  <span class="mf">1.5158663e+02</span> <span class="mf">1.25e-03</span> <span class="mf">9.80e-04</span>  <span class="o">-</span><span class="mf">3.8</span> <span class="mf">2.38e-01</span>  <span class="o">-</span><span class="mf">2.4</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">7</span>  <span class="mf">1.0229631e+02</span> <span class="mf">2.37e-03</span> <span class="mf">4.26e-04</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">3.11e-01</span>  <span class="o">-</span><span class="mf">2.9</span> <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
   <span class="mi">8</span>  <span class="mf">8.6220145e+01</span> <span class="mf">1.84e-01</span> <span class="mf">3.73e-04</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">2.84e+01</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.25e-01</span><span class="n">h</span>  <span class="mi">4</span>
   <span class="mi">9</span>  <span class="mf">1.6663658e+00</span> <span class="mf">6.98e-02</span> <span class="mf">4.71e-05</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">2.20e+00</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
<span class="n">iter</span>    <span class="n">objective</span>    <span class="n">inf_pr</span>   <span class="n">inf_du</span> <span class="n">lg</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>  <span class="o">||</span><span class="n">d</span><span class="o">||</span>  <span class="n">lg</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span> <span class="n">alpha_du</span> <span class="n">alpha_pr</span>  <span class="nb">ls</span>
  <span class="mi">10</span>  <span class="mf">1.1303218e-01</span> <span class="mf">1.61e-02</span> <span class="mf">9.28e-07</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">4.53e-01</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
  <span class="mi">11</span>  <span class="mf">3.7959122e-02</span> <span class="mf">7.79e-03</span> <span class="mf">2.54e-08</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">2.84e-01</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
  <span class="mi">12</span>  <span class="mf">2.1316195e-02</span> <span class="mf">1.77e-03</span> <span class="mf">4.98e-09</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">1.39e-01</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
  <span class="mi">13</span>  <span class="mf">1.8447375e-02</span> <span class="mf">6.30e-06</span> <span class="mf">5.26e-11</span>  <span class="o">-</span><span class="mf">5.7</span> <span class="mf">8.15e-03</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>
  <span class="mi">14</span>  <span class="mf">1.8440851e-02</span> <span class="mf">2.26e-09</span> <span class="mf">9.54e-15</span>  <span class="o">-</span><span class="mf">8.6</span> <span class="mf">1.61e-04</span>    <span class="o">-</span>  <span class="mf">1.00e+00</span> <span class="mf">1.00e+00</span><span class="n">h</span>  <span class="mi">1</span>

<span class="n">Number</span> <span class="n">of</span> <span class="n">Iterations</span><span class="k">...</span><span class="c">.: 14</span>

                                   <span class="p">(</span><span class="n">scaled</span><span class="p">)</span>                 <span class="p">(</span><span class="n">unscaled</span><span class="p">)</span>
<span class="n">Objective</span><span class="k">...</span><span class="c">............:   9.2204254694796125e-07    1.8440850938959225e-02</span>
<span class="n">Dual</span> <span class="n">infeasibility</span><span class="k">...</span><span class="c">...:   9.5381182640930876e-15    1.9076236528186175e-10</span>
<span class="n">Constraint</span> <span class="n">violation</span><span class="k">...</span><span class="c">.:   2.2559639156760625e-09    2.2559639156760625e-09</span>
<span class="n">Complementarity</span><span class="k">...</span><span class="c">......:   0.0000000000000000e+00    0.0000000000000000e+00</span>
<span class="n">Overall</span> <span class="n">NLP</span> <span class="nb">error</span><span class="k">...</span><span class="c">....:   2.2559639156760625e-09    2.2559639156760625e-09</span>


<span class="n">Number</span> <span class="n">of</span> <span class="n">objective</span> <span class="k">function</span> <span class="n">evaluations</span>             <span class="o">=</span> <span class="mi">19</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">objective</span> <span class="nb">gradient</span> <span class="n">evaluations</span>             <span class="o">=</span> <span class="mi">15</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraint</span> <span class="n">evaluations</span>            <span class="o">=</span> <span class="mi">19</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">inequality</span> <span class="n">constraint</span> <span class="n">evaluations</span>          <span class="o">=</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">equality</span> <span class="n">constraint</span> <span class="n">Jacobian</span> <span class="n">evaluations</span>   <span class="o">=</span> <span class="mi">15</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">inequality</span> <span class="n">constraint</span> <span class="n">Jacobian</span> <span class="n">evaluations</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Number</span> <span class="n">of</span> <span class="n">Lagrangian</span> <span class="n">Hessian</span> <span class="n">evaluations</span>             <span class="o">=</span> <span class="mi">14</span>
<span class="n">Total</span> <span class="n">CPU</span> <span class="n">secs</span> <span class="n">in</span> <span class="n">IPOPT</span> <span class="p">(</span><span class="n">w</span><span class="p">/</span><span class="n">o</span> <span class="k">function</span> <span class="n">evaluations</span><span class="p">)</span>   <span class="o">=</span>      <span class="mf">0.415</span>
<span class="n">Total</span> <span class="n">CPU</span> <span class="n">secs</span> <span class="n">in</span> <span class="n">NLP</span> <span class="k">function</span> <span class="n">evaluations</span>           <span class="o">=</span>      <span class="mf">0.065</span>

<span class="n">EXIT</span><span class="p">:</span> <span class="n">Optimal</span> <span class="n">Solution</span> <span class="n">Found</span><span class="o">.</span>
               <span class="n">t_proc</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>   <span class="n">t_wall</span> <span class="p">[</span><span class="n">s</span><span class="p">]</span>    <span class="n">n_eval</span>
       <span class="n">nlp_f</span>     <span class="mf">0.000898</span>     <span class="mf">0.000903</span>        <span class="mi">19</span>
       <span class="n">nlp_g</span>      <span class="mf">0.00904</span>      <span class="mf">0.00905</span>        <span class="mi">19</span>
  <span class="n">nlp_grad_f</span>       <span class="mf">0.0017</span>      <span class="mf">0.00169</span>        <span class="mi">16</span>
  <span class="n">nlp_hess_l</span>       <span class="mf">0.0214</span>       <span class="mf">0.0214</span>        <span class="mi">14</span>
   <span class="n">nlp_jac_g</span>       <span class="mf">0.0354</span>        <span class="mf">0.035</span>        <span class="mi">16</span>
      <span class="n">solver</span>        <span class="mf">0.489</span>        <span class="mf">0.487</span>         <span class="mi">1</span>
<span class="n">Elapsed</span> <span class="n">time</span> <span class="nb">is</span> <span class="mf">0.616536</span> <span class="n">seconds</span><span class="o">.</span>

</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">plotSHE</span><span class="p">(</span><span class="n">OptState</span><span class="p">,</span><span class="n">OptControl</span><span class="p">,</span><span class="n">Yfree</span><span class="p">,</span><span class="n">YT</span><span class="p">,</span><span class="n">xline</span><span class="p">,</span><span class="n">tspan</span><span class="p">,</span><span class="n">Nt</span><span class="p">)</span>
</code></pre>
</div>

<table>
    <tr>
        <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_11.png" />
        </th>
         <th>
            <img src="https://deustotech.github.io//DyCon-Blog/assets/imgs/WP06/P0008/copiaRM_10.png" />
        </th>       
    </tr>
</table>

        <hr>
      </div>
    </div>
  </div>
  <div id="content" class="container">

  <div class="relatedPosts">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
    <h2>Related Posts</h2>
    
    
    
    
    

    
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP06/P0007/ico.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp06/P0007" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> The Optimal control on the Kuramoto adaptative coupling model with DyCon Toolbox </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this DyCon Toolbox tutorial, we present how to use OptimaControl enviroment to control a consensus that models the complex emergent dynamics over a given network.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/DongnamK">Dongnam Ko</a>
          
          - 01 April 2020
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-success btn-sm" style="margin-left: auto;">DyCon Toolbox</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP06/P0006/avatar.png">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp06/P0006" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Optimal Control Problem with CasADi on null-controllability of the network system </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      The aim of this work is to use CasADi and IpOpt to simulate optimal control problem, which explains the structural controllability of the 2D heat equation. We use finite difference scheme with the uniform grid to test exact controllability of the 2D heat equation. After that, we delete several interactions between grid points and simulate the controllability with smaller number of controlled points.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/DongnamK">Dongnam Ko</a>
          
          - 07 November 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-danger btn-sm" style="margin-left: auto;">MATLAB-CasADi</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP06/P0005/ds.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp06/P0005" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Optimal strategies for guidance-by-repulsion model with IpOpt and AMPL </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this post, we use IpOpt and AMPL to simulate optimal controls on a nonlinear ODE system with unbounded interactions. The restriction and initial guess on the state variables are critical for this problem to operate minimization algorithm. From the data calculated from AMPL, we interpret and visualize it using Matlab.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/DongnamK">Dongnam Ko</a>
          
          - 27 May 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-dark btn-sm" style="margin-left: auto;">AMPL Ipopt</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP06/P0004/copiaRM_05.png">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp06/P0004" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> The control on the Kuramoto model by handling one oscillator </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      We design the LQR controller and solve it with linearized model.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/DongnamK">Dongnam Ko</a>
          
          - 29 October 2018
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
            
    </div>
  </div> 
    </div>
  </div>

</article>
<hr>

    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <ul class="list-inline text-center">
        <li style="margin-right: 50px;">
          <img style="width: 250px;" src="/DyCon-Blog/img/logos/logo_DyCon.png " alt="">
        </li>
        <li style="padding-bottom: 5px;">
          <img style="width: 230px;" src="/DyCon-Blog/img/logos/logo_CCM_subDerecha_v002.png " alt="">
        </li>
      </ul>
    </div>
  </div>
</footer>

</body>
</html>
