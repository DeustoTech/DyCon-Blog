<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">
	<link rel='shortcut icon' type='image/png' href='/DyCon-Blog/favicon.png' />

  <title>
    Optimal Shape Design in External Flow - DyCon Blog
    
  </title>

  <link rel="canonical" href="https://deustotech.github.io/DyCon-Blog/tutorial/ot01/P0018">

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/clean-blog.css">

   <!-- Adjust Colors -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/colorscheme.css">

  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/syntax.css">


  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/libgif.js "></script>
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/rubbable.js "></script>


  <!-- Google Fonts Raleway -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
	<!-- MathJax -->
  <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      },
      extensions: ["AMSmath.js", "AMSsymbols.js"],
      Macros:{
        norm: ["|| #1 ||",1],
        abs: ["| #1 |",1],
        hdots: "...",
        RR: "\\mathbb{R}",
        ffl: ["(d_x^2)^{#1}",1],
        ccs: "c_{1,s}",
        kernel: ["|x-y|^{#1}",1],
        ue: ["#1^{\\epsilon}",1]
      }
    },
    CommonHTML: {
      styles: {
        "@font-face /* vec */ ": {
          "font-family": "MJX-VEC",
          src: [
            "url(data:application/x-font-woff;charset=utf-8;base64,",
            "d09GRgABAAAAAARMAA0AAAAABiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEMAAAABwA",
            "AAAccRGLqUdERUYAAAQMAAAAJAAAACgANAAmT1MvMgAAAaAAAABJAAAAYFc5gfFjbWFwAAACAAAA",
            "AEYAAAFKQxjlbWdhc3AAAAQEAAAACAAAAAj//wADZ2x5ZgAAAlQAAACUAAAAlIQU9HBoZWFkAAAB",
            "MAAAADAAAAA2C748e2hoZWEAAAFgAAAAHgAAACQFXQDqaG10eAAAAewAAAAUAAAAFAYvAE9sb2Nh",
            "AAACSAAAAAwAAAAMACgAcm1heHAAAAGAAAAAHQAAACAASQAmbmFtZQAAAugAAADxAAAB5uwlD0hw",
            "b3N0AAAD3AAAACgAAAA34M9aEXjaY2BkYGAA4uOfgq7G89t8ZeBmfgEUYbga+icNTssClVxnOgXk",
            "cjAwgUQBdqEMW3jaY2BkYGBu+feBgYHxCwMQMF5nYGRABawAcaQESgAAeNpjYGRgYGBlUGZgYgAB",
            "EMnIABJzAPMZAAZZAHAAAAB42mNgYSxn/MLAysDA1MW0h4GBoQdCMz5gMGRkAooysDEzwAAjECvA",
            "OAFprikMBxgUFCcxt/z7wMDA3MIoAFUDAwoMjACD8Qv5AAAAAfQAMgAAAAABTQAAAPoAAAH0AB14",
            "2mNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYFBQn/f8P5IPp/4/vFUHVAwEjGwOcw8gEJJgY",
            "UAEjxIrhDACLGwmnAAAAAAAUABQAFAAUAEoAAgAyAAABwgIVAAMABwAAMxEhESUhESEyAZD+ogEs",
            "/tQCFf3rMgGxAAEAHQIEAdcCygAiAAABNDYzMhcWFxYXFhUUBgcGBw4DIyImNTQ3IycmNTQ3ISYB",
            "eQsJBwUFBQofCwYLKyACBwMGBAcNL6urDQ0BZxgCtggMBQQPJRQHCwkGBhYpAgkCAgsJEygBCQoH",
            "DSYAeNqVjrGKwkAURe/EGBBUrG12CishMrFQcDuLsAi26YMOmsIMxAh+hN8i+CF+gd+y4B3zttjC",
            "woHhncu7774HoI8rFP5eIKzQw5dwgAjfwi2McBEO6bkLtzHAr3CEnhrTqcKOpDasMCQ1HKCLWLiF",
            "HyyFQ3puwm1oPIQjDFXfR62Ro8YeK9YzMlhsqB0qtvJ6v8rPmd3Uzkv2tihwwoHCbosTa0pryYH0",
            "NbKjRWPB/z626Se8dsY/hSHPGeTKOnXVzuqF/reYOoln8dQk80+u9b0KR97rD9Rc4xdNXtVQI7PV",
            "sXClNiaZGGP0B+FPMN1KMAAAAHjaY2BiAIP/zQxGDNgAKxAzMjAxMDMycSUWFeWXF2WmZ5QAAGh5",
            "BhgAAAAB//8AAnjaY2BkYGDgA2IJBgUgycTAyMDMwAIkWcA8BgZGCAYACgIAWwAAAAEAAAAAxmW3",
            "ygAAAADVVeemAAAAANVV7Dg=) format('woff')"
          ].join('')
        },
        ".MJX-VEC": {
          "font-family": "MJX-VEC"
        }
      }
    }
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
  <script src="https://deustotech.github.io/DyCon-Blog/js/clean-blog.min.js "></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128123935-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128123935-3');
  </script>
  <!-- End Google Analytics -->



  <!-- marKdown editor -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
  <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
</head>

<body>
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/DyCon-Blog/">
                 <img src="https://deustotech.github.io//DyCon-Blog//assets/logo_DyCon.png">
            </a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/DyCon-Blog/">Home</a>
                </li>
                
                
                <li>
                    <a href="/DyCon-Blog/projects/posts">Documentation</a>
                </li>
                
                <li>
                    <a href="/DyCon-Blog/projects/authors">Authors</a>
                </li>
                
                <li>
                        <a href="https://deustotech.github.io/DyCon-Blog/projects/search.byWP">Sitemap</a>
                </li>
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Post Header -->
<header class="intro-header">
  <div class="container" style="padding-top: 70px;">
    <div class="row">
      <div class="col-lg-10 col-md-10 col-md-offset-1">
        <div class="post-heading" style="padding: 0px 0"><h2><small class="light-grey"><a href="https://deustotech.github.io//DyCon-Blog/projects/posts">Work Packages</a>
            &#8827;<a href="https://deustotech.github.io//DyCon-Blog/workpackage/OT01">
            Optimal Control in OpenFOAM</a> &#8827;</small>
          </h2>
          <h1>Optimal Shape Design in External Flow</h1>
					<p class="meta">
            <div class="post-preview-authors ellipsis-one-line">
              Author:
              
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/JoseV">Jos√© Vicente</a>
                  </span>
                </span>
              
              - 30 June 2018
            </div>
					</p>
        </div>
      </div>
		</div>
	</div>
</header>
<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>
<article>
  <div id="content" class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          
            <a href="https://github.com/ChairOfComputationalMathematics/shapeOptimizationFoam/archive/master.zip""><i class="fa fa-download fa-lg"></i>Download Code</a>
          
        
        <p>A natural application in the framework of shape optimization is the aerodynamic design of an airfoil. An object defined by a domain <img src="https://latex.codecogs.com/gif.latex?%5COmega_s%20%5Cin%20%5Cmathbb%7BR%7D%5Ed" /> with boundary <img src="https://latex.codecogs.com/gif.latex?%5CGamma_s" /> immersed in a fluid will experience a net force given by</p>

<p align="center">
  <img src="https://latex.codecogs.com/gif.latex?F_i%20%3D%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%7D%20-%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cbm%7Bu%7D%5Cright%29%20%5C%2C%20n_j%20%5C%20%5Cmathrm%7Bd%7D%20%5CGamma%2C" />
</p>

<p>where <img src="https://latex.codecogs.com/gif.latex?%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cbm%7Bu%7D%5Cright%29%20%3D%20-p%20%5Cdelta_%7Bij%7D%20&plus;%202%5Cnu%20S_%7Bij%7D%5Cleft%28%5Cbm%7Bu%7D%5Cright%29" /> is the stress tensor, <img src="https://latex.codecogs.com/gif.latex?p" /> is the fluid pressure, <img src="https://latex.codecogs.com/gif.latex?%5Cnu" /> is the kinematic viscosity, <img src="https://latex.codecogs.com/gif.latex?S_%7Bij%7D%5Cleft%28%5Cmathbf%7Bu%7D%5Cright%29%20%3D%20%5Cfrac%7B1%7D%7B2%7D%20%5Cleft%28%20%5Cpartial_j%20u_i%20&plus;%20%5Cpartial_i%20u_j%20%5Cright%29" /> is the strain rate tensor, and <img src="https://latex.codecogs.com/gif.latex?%5Cmathbf%7Bu%7D%20%5Cin%20%5Cmathbb%7BR%7D%5Ed" /> is the fluid velocity vector field.</p>

<p align="center">
  <img src="https://raw.githubusercontent.com/ChairOfComputationalMathematics/shapeOptimizationFoam/master/figs/fig1.png" width="400" height="320" />
</p>

<p>The force exerted by the fluid on the airfoil parallel to the fluid velocity at infinity is referred to as the drag force, whereas the force in perpendicular direction is often named the lift.</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?D%20%3D%20d%5ED_i%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%7D%20-%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cbm%7Bu%7D%5Cright%29%20%5C%2C%20n_j%20%5C%20%5Cmathrm%7Bd%7D%20%5CGamma%2C" />
</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?L%20%3D%20d%5EL_i%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%7D%20-%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cbm%7Bu%7D%5Cright%29%20%5C%2C%20n_j%20%5C%20%5Cmathrm%7Bd%7D%20%5CGamma." />
</p>

<p>We look for the optimal shape in order to minimize the drag, as this force produces energy losses, and at the same time maximize the lift for a fixed airfoil volume. This can be expressed by means of the functional</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cmathcal%7BJ%7D%20%5Cleft%28%20%5Ctheta%20%5Cright%29%20%3D%20w%5ED%20D%20-%20w%5EL%20L%20%3D%20d_i%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%29%7D%20-%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cmathbf%7Bu%7D%5Cright%29n_j%20%5Cmathrm%7Bd%7D%20%5CGamma%2C" />
</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?d_i%20%3D%20w%5ED%20d%5ED_i%20-%20w%5EL%20d%5EL_i%2C" />
</p>

<p>where <img src="https://latex.codecogs.com/gif.latex?w%5ED" /> and <img src="https://latex.codecogs.com/gif.latex?w%5EL" /> are weighting factors for drag and lift forces, respectively, and with <img src="https://latex.codecogs.com/gif.latex?%5Ctheta%20%5Cin%20L%5E2%5Cleft%28%20%5CGamma_s%20%5Cright%29" />. The state variables are subject to a set of constraints in the fluid domain <img src="https://latex.codecogs.com/gif.latex?%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29" /> with boundary <img src="https://latex.codecogs.com/gif.latex?%5CGamma_f%20%3D%20%5CGamma_%7Bin%7D%20%5Ccup%20%5CGamma_%7Bout%7D%20%5Ccup%20%5CGamma_s%5Cleft%28%20%5Ctheta%20%5Cright%20%29%20%5Ccup%20%5CGamma_w" />, namely the steady Navier-Stokes equations,</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cbegin%7Bcases%7D%20u_j%20%5Cpartial_j%20u_i%20-%20%5Cpartial_j%20%5Cleft%5B%20%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cmathbf%7Bu%7D%20%5Cright%29%20%5Cright%5D%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20%5Cpartial_j%20u_j%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20u_i%20%3D%20u%5E%5Cinfty_i%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_%7Bin%7D%2C%20%5C%5C%20u_i%20%3D%200%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%20%5Ccup%20%5CGamma_w%2C%20%5C%5C%20%5Csigma_%7Bij%7D%20%5Cleft%28p%2C%20%5Cmathbf%7Bu%7D%20%5Cright%29%20n_j%20%3D%200%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_%7Bout%7D%2C%20%5Cend%7Bcases%7D" />
</p>

<p>and to the volume constraint</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cleft%7C%20%5COmega_%7Bs%7D%20%5Cright%7C%20%3D%20%5COmega_0." />
</p>

<p>The adjoint problem reads as</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cbegin%7Bcases%7D%20v_j%20%5Cpartial_i%20u_j%20-%20%5Cpartial_j%20%5Cleft%28%20u_j%20v_i%20%5Cright%29%20-%20%5Cpartial_j%20%5Cleft%5B%20%5Csigma_%7Bij%7D%20%5Cleft%28q%2C%20%5Cmathbf%7Bv%7D%20%5Cright%29%20%5Cright%5D%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20%5Cpartial_j%20v_j%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20v_i%20%3D%200%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_%7Bin%7D%20%5Ccup%20%5CGamma_w%2C%20%5C%5C%20v_i%20%3D%20-d_i%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20%5Csigma_%7Bij%7D%20%5Cleft%28q%2C%20%5Cmathbf%7Bv%7D%20%5Cright%29%20n_j%20&plus;%20v_i%20u_j%20n_j%20%3D%200%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_%7Bout%7D.%20%5Cend%7Bcases%7D" />
</p>

<p>The directional derivative of the functional is given by</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cmathcal%7BD%7D_%7B%5Cdelta%20%5Ctheta%7D%20%5Cmathcal%7BJ%7D%20%3D%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%7D%20%5Cleft%5B%20r%20-%202%20%5Cnu%20S_%7Bij%7D%20%5Cleft%28%20%5Cmathbf%7Bv%7D%20%5Cright%29%20%5C%2C%20n_j%20%5C%2C%20n_k%20%5C%2C%20%5Cpartial_k%20u_i%20%5Cright%5D%20%5C%2C%20%5Cdelta%20%5Ctheta%20%5C%20%5Cmathrm%7Bd%7D%20%5CGamma%2C" />
</p>

<p>and the cost function descreases by choosing the normal displacement to the controlled boundary as</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cdelta%20%5Ctheta%20%5E%7B%5Cleft%28n%5Cright%29%7D%20%3D%20-%20%5Cleft%5B%20r%5E%7B%5Cleft%28n%5Cright%29%7D%20-%202%20%5Cnu%20S_%7Bij%7D%20%5Cleft%28%20%5Cmathbf%7Bv%7D%5E%7B%5Cleft%28n%5Cright%29%7D%20%5Cright%29%20%5C%2C%20n_j%5E%7B%5Cleft%28n%5Cright%29%7D%20%5C%20n_k%5E%7B%5Cleft%28n%5Cright%29%7D%20%5C%2C%20%5Cpartial_k%20u_i%5E%7B%5Cleft%28n%5Cright%29%7D%20%5Cright%5D." />
</p>

<p>Hence,</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Ctheta%20%5E%7B%5Cleft%28n&plus;1%5Cright%29%7D%20%3D%20%5Ctheta%20%5E%7B%5Cleft%28n%5Cright%29%7D%20&plus;%20%5Cepsilon%20%5Cdelta%20%5Ctheta%20%5E%7B%5Cleft%28n%5Cright%29%7D%2C" />
</p>

<p>for a sufficiently small value of <img src="https://latex.codecogs.com/gif.latex?%5Cepsilon" />.</p>

<p>The remaining Lagrange multiplier associated to the volume constraint is computed in order to ensure the volume conservation,</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?r%5E%7B%5Cleft%28n%5Cright%29%7D%20%3D%20%5Cfrac%7B1%7D%7B%5Cleft%7C%20%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%20%5Cright%7C%7D%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%7D%202%20%5Cnu%20S_%7Bij%7D%20%5Cleft%28%20%5Cmathbf%7Bv%7D%5E%7B%5Cleft%28n%5Cright%29%7D%20%5Cright%29%20n_j%5E%7B%5Cleft%28n%5Cright%29%7D%20n_k%5E%7B%5Cleft%28n%5Cright%29%7D%20%5Cpartial_k%20u_i%5E%7B%5Cleft%28n%5Cright%29%7D%20%5C%20%5Cmathrm%7Bd%7D%20%5CGamma." />
</p>

<p>In summary, the shape optimization iteration is as follows:</p>
<ul>
  <li>Solve the primal problem.</li>
  <li>Solve the adjoint problem with the previously computed state variables.</li>
  <li>Compute the Lagrange multiplier for the volume constraint.</li>
  <li>Compute the displacement field.</li>
  <li>Update the displacement field of the previous iteration.</li>
  <li>Perform the mesh motion.</li>
</ul>

<h2 id="getting-started">Getting Started</h2>

<p>The solver must be compiled in the terminal. It is advisable to first clean previous compilations with</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wclean
</code></pre></div></div>

<p>and then use</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wmake
</code></pre></div></div>

<h3 id="prerequisites">Prerequisites</h3>

<p>OpenFOAM C++ library must be installed in order to compile the code.</p>

<p>The OpenFOAM distribution provided by the <a href="https://openfoam.org/">OpenFOAM Foundation</a> was used.</p>

<h2 id="running-a-case">Running a Case</h2>

<p>The above shape optimization process has been implemented in the open-source C++ library OpenFOAM. The already existing solver <em>adjointShapeOptimizationFoam</em> is a topological optimization routine that relies on a porosity variable and on the calculation of volume sensitivities to determine which regions of the domain must be blocked to the fluid passage in order to minimize a known functional. We have coded a new solver <em>shapeOptimizationFoam</em> that takes some ideas from the aforementioned one, but which performs a shape optimization iteration instead by computing shape sensitivities.</p>

<p align="center">
    <img src="https://raw.githubusercontent.com/ChairOfComputationalMathematics/shapeOptimizationFoam/master/shapeOptimizationFoamCase/figs/fig1.png" width="400" height="320" />
</p>

<p>The solver has been tested in the minimization of the the cost function</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cmathcal%7BJ%7D%20%5Cleft%28%20%5Ctheta%20%5Cright%29%20%3D%20%5Cleft%28%20w%5ED%20d%5ED_i%20-%20w%5EL%20d%5EL_i%20%5Cright%29%20%5Cint_%7B%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%29%7D%20-%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cmathbf%7Bu%7D%5Cright%29n_j%20%5C%20%5Cmathrm%7Bd%7D%20%5CGamma%2C" />
</p>

<p>subject to</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cbegin%7Bcases%7D%20u_j%20%5Cpartial_j%20u_i%20-%20%5Cpartial_j%20%5Cleft%5B%20%5Csigma_%7Bij%7D%5Cleft%28p%2C%20%5Cmathbf%7Bu%7D%20%5Cright%29%20%5Cright%5D%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%29%20%5Cright%20%29%2C%20%5C%5C%20%5Cpartial_j%20u_j%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%29%20%5Cright%20%29%2C%20%5C%5C%20u_i%20%3D%20u%5E%5Cinfty_i%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_%7B%5Cinfty%7D%2C%20%5C%5C%20u_i%20%3D%200%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%29%20%5Cright%20%29.%20%5C%5C%20%5Cend%7Bcases%7D" />
</p>

<p>The adjoint problem reads as</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cbegin%7Bcases%7D%20v_j%20%5Cpartial_i%20u_j%20-%20%5Cpartial_j%20%5Cleft%28%20u_j%20v_i%20%5Cright%29%20-%20%5Cpartial_j%20%5Cleft%5B%20%5Csigma_%7Bij%7D%20%5Cleft%28q%2C%20%5Cmathbf%7Bv%7D%20%5Cright%29%20%5Cright%5D%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20%5Cpartial_j%20v_j%20%3D%200%20%26%20%5Ctext%7Bin%20%7D%20%5COmega_f%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29%2C%20%5C%5C%20v_i%20%3D%200%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_%7B%5Cinfty%7D%2C%20%5C%5C%20v_i%20%3D%20-d_i%20%26%20%5Ctext%7Bon%20%7D%20%5CGamma_s%20%5Cleft%28%20%5Ctheta%20%5Cright%20%29.%20%5C%5C%20%5Cend%7Bcases%7D" />
</p>

<p>In order to run the solver move to the case folder <em>shapeOptimizationFoamCase</em> and type in the command line</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./Allprepare

shapeOptimizationFoam
</code></pre></div></div>

<p>The solver has been run for three different Reynolds numbers and the cost functional value has been normalized with</p>

<p align="center">
    <img src="https://latex.codecogs.com/gif.latex?%5Cfrac%7B1%7D%7B2%7D%20%5Crho%20U_%7B%5Cinfty%7D%5E2%20D%20e" />
</p>

<p>where <img src="https://latex.codecogs.com/gif.latex?D" /> and <img src="https://latex.codecogs.com/gif.latex?e" /> are the cylinder diameter and thickness, respectively.</p>

<p align="center">
    <img src="https://raw.githubusercontent.com/ChairOfComputationalMathematics/shapeOptimizationFoam/master/shapeOptimizationFoamCase/figs/fig2.png" />
</p>

<h3 id="warning">Warning</h3>

<p>It might be needed to use</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sed -i -e 's/\r$//' filename
</code></pre></div></div>

<p>and</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod +x filename
</code></pre></div></div>

<p>in order to be able to execute</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./filename
</code></pre></div></div>

<h2 id="references">References</h2>

<ul>
  <li>Antony Jameson. Aerodynamic design via control theory. <em>Journal of scientific computing</em>, 3(3):233‚Äì260, 1988.</li>
  <li>Antony Jameson and Luigi Martinelli. Aerodynamic shape optimization techniques based on control theory. In <em>Computational Mathematics Driven by Industrial Problems</em>, pages 151‚Äì221. Springer, 2000.</li>
  <li>Antony Jameson and James Reuther. Control theory based airfoil design using the euler equations. In <em>5th Symposium on Multidisciplinary Analysis and Optimization</em>, page 4272, 1994.</li>
  <li>Bijan Mohammadi and Olivier Pironneau. Mesh adaption and automatic differentiation in a cad-free framework for optimal shape design. <em>International Journal for Numerical Methods in Fluids</em>, 30(2):127‚Äì136, 1999.</li>
  <li>Bijan Mohammadi and Olivier Pironneau. <em>Applied shape optimization for fluids</em>. Oxford University Press, 2010.</li>
  <li>C. Othmer. A continuous adjoint formulation for the computation of topological and surface sensitivities of ducted flows. <em>International Journal for Numerical Methods in Fluids</em>, 58(8):861‚Äì877, 2008.</li>
  <li>C. Othmer, E. Papoutsis-Kiachagias, and K. Haliskos. CFD optimization via sensitivity-based shape morphing. In <em>Proceedings of the 4th ANSA &amp; ŒºETA Internat. Conf., Thessaloniki, Greece, BETA CAE Systems SA</em>, 2011.</li>
  <li>Carsten Othmer. Adjoint methods for car aerodynamics. <em>Journal of Mathematics in Industry</em>, 4(1):6, 2014.</li>
  <li>Carsten Othmer, Eugene de Villiers, and Henry Weller. Implementation of a continuous adjoint for topology optimization of ducted flows. In <em>18th AIAA Computational Fluid Dynamics Conference</em>, page 3947, 2007.</li>
  <li>Carsten Othmer and Thorsten Grahs. Approaches to fluid dynamic optimization in the car development process. In <em>International Conference on Evolutionary and Deterministic Methods for Design, Optimization and Control With Applications to Industrial and Societal Problems</em>, 2005.</li>
  <li>Carsten Othmer, Thomas Kaminski, and Ralf Giering. Computation of topological sensitivities in fluid dynamics: cost function versatility. In <em>ECCOMAS CFD 2006: Proceedings of the European Conference on Computational Fluid Dynamics, Egmond aan Zee, The Netherlands, September 5-8, 2006</em>. Citeseer, 2006.</li>
  <li>Olivier Pironneau. <em>Optimal shape design for elliptic systems</em>. Springer Science &amp; Business Media, 2012.</li>
  <li>James Reuther and Antony Jameson. Aerodynamic shape optimization of wing and wing-body configurations using control theory. In <em>33rd Aerospace Sciences Meeting and Exhibit</em>, page 123, 1995.</li>
  <li>James Reuther, Antony Jameson, James Farmer, Luigi Martinelli, and David Saunders. Aerodynamic shape optimization of complex aircraft configurations via an adjoint formulation. In <em>34th Aerospace Sciences Meeting and Exhibit</em>, page 94, 1996.</li>
  <li>James J Reuther, Antony Jameson, Juan J Alonso, Mark J Rimlinger, and David Saunders. Constrained multipoint aerodynamic shape optimization using an adjoint formulation and parallel computers, part 1. <em>Journal of aircraft</em>, 36(1):51‚Äì60, 1999.</li>
  <li>J. Simon. Diferenciaci√≥n de problemas de contorno respecto del dominio. Technical report, Universidad de Sevilla, Facultad de Matem√°ticas, Departamento de An√°lisis Matem√°tico, 1989.</li>
  <li>Orlando Soto and Rainald L√∂hner. On the computation of flow sensitivities from boundary integrals. <em>AIAA paper</em>, 112:2004, 2004.</li>
  <li>Orlando Soto, Rainald L√∂hner, and Chi Yang. An adjoint-based design methodology for CFD problems. <em>International Journal of Numerical Methods for Heat &amp; Fluid Flow</em>, 14(6):734‚Äì759, 2004.</li>
  <li>Schumacher Thomas, Othmer Carsten, et al. Adjoint optimization for vehicle external aerodynamics. <em>International Journal of Automotive Engineering</em>, 7(1):1‚Äì7, 2016.</li>
  <li>Henk Kaarle Versteeg and Weeratunge Malalasekera. <em>An introduction to computational fluid dynamics: the finite volume method</em>. Pearson Education, 2007.</li>
  <li>F. Feppon, G. Allaire, F. Bordeu, J. Cortial, and C. Dapogny. Shape optimization of a coupled thermal fluid-structure problem in a level set mesh evolution framework, 2018.</li>
</ul>

        <hr>
      </div>
    </div>
  </div>
</article>
<hr>

    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <ul class="list-inline text-center">
        <li style="margin-right: 50px;">
          <img style="width: 250px;" src="/DyCon-Blog/img/logos/logo_DyCon.png " alt="">
        </li>
        <li style="padding-bottom: 5px;">
          <img style="width: 230px;" src="/DyCon-Blog/img/logos/logo_CCM_subDerecha_v002.png " alt="">
        </li>
      </ul>
    </div>
  </div>
</footer>

</body>
</html>
