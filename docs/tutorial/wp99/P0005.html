<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">
	<link rel='shortcut icon' type='image/png' href='/DyCon-Blog/favicon.png' />

  <title>
    Two Grids Filter Method for RPS Semi-Discretization - DyCon Blog
    
  </title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="canonical" href="https://deustotech.github.io/DyCon-Blog/tutorial/wp99/P0005">

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/clean-blog.css">

   <!-- Adjust Colors -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/colorscheme.css">

  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/syntax.css">

  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/google-search.css">


  
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/libgif.js "></script>
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/rubbable.js "></script>


  <!-- Google Fonts Raleway -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
	<!-- MathJax -->
  <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      },
      extensions: ["AMSmath.js", "AMSsymbols.js"],
      Macros:{
        norm: ["|| #1 ||",1],
        abs: ["| #1 |",1],
        hdots: "...",
        RR: "\\mathbb{R}",
        ffl: ["(d_x^2)^{#1}",1],
        ccs: "c_{1,s}",
        kernel: ["|x-y|^{#1}",1],
        ue: ["#1^{\\epsilon}",1]
      }
    },
    CommonHTML: {
      styles: {
        "@font-face /* vec */ ": {
          "font-family": "MJX-VEC",
          src: [
            "url(data:application/x-font-woff;charset=utf-8;base64,",
            "d09GRgABAAAAAARMAA0AAAAABiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEMAAAABwA",
            "AAAccRGLqUdERUYAAAQMAAAAJAAAACgANAAmT1MvMgAAAaAAAABJAAAAYFc5gfFjbWFwAAACAAAA",
            "AEYAAAFKQxjlbWdhc3AAAAQEAAAACAAAAAj//wADZ2x5ZgAAAlQAAACUAAAAlIQU9HBoZWFkAAAB",
            "MAAAADAAAAA2C748e2hoZWEAAAFgAAAAHgAAACQFXQDqaG10eAAAAewAAAAUAAAAFAYvAE9sb2Nh",
            "AAACSAAAAAwAAAAMACgAcm1heHAAAAGAAAAAHQAAACAASQAmbmFtZQAAAugAAADxAAAB5uwlD0hw",
            "b3N0AAAD3AAAACgAAAA34M9aEXjaY2BkYGAA4uOfgq7G89t8ZeBmfgEUYbga+icNTssClVxnOgXk",
            "cjAwgUQBdqEMW3jaY2BkYGBu+feBgYHxCwMQMF5nYGRABawAcaQESgAAeNpjYGRgYGBlUGZgYgAB",
            "EMnIABJzAPMZAAZZAHAAAAB42mNgYSxn/MLAysDA1MW0h4GBoQdCMz5gMGRkAooysDEzwAAjECvA",
            "OAFprikMBxgUFCcxt/z7wMDA3MIoAFUDAwoMjACD8Qv5AAAAAfQAMgAAAAABTQAAAPoAAAH0AB14",
            "2mNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYFBQn/f8P5IPp/4/vFUHVAwEjGwOcw8gEJJgY",
            "UAEjxIrhDACLGwmnAAAAAAAUABQAFAAUAEoAAgAyAAABwgIVAAMABwAAMxEhESUhESEyAZD+ogEs",
            "/tQCFf3rMgGxAAEAHQIEAdcCygAiAAABNDYzMhcWFxYXFhUUBgcGBw4DIyImNTQ3IycmNTQ3ISYB",
            "eQsJBwUFBQofCwYLKyACBwMGBAcNL6urDQ0BZxgCtggMBQQPJRQHCwkGBhYpAgkCAgsJEygBCQoH",
            "DSYAeNqVjrGKwkAURe/EGBBUrG12CishMrFQcDuLsAi26YMOmsIMxAh+hN8i+CF+gd+y4B3zttjC",
            "woHhncu7774HoI8rFP5eIKzQw5dwgAjfwi2McBEO6bkLtzHAr3CEnhrTqcKOpDasMCQ1HKCLWLiF",
            "HyyFQ3puwm1oPIQjDFXfR62Ro8YeK9YzMlhsqB0qtvJ6v8rPmd3Uzkv2tihwwoHCbosTa0pryYH0",
            "NbKjRWPB/z626Se8dsY/hSHPGeTKOnXVzuqF/reYOoln8dQk80+u9b0KR97rD9Rc4xdNXtVQI7PV",
            "sXClNiaZGGP0B+FPMN1KMAAAAHjaY2BiAIP/zQxGDNgAKxAzMjAxMDMycSUWFeWXF2WmZ5QAAGh5",
            "BhgAAAAB//8AAnjaY2BkYGDgA2IJBgUgycTAyMDMwAIkWcA8BgZGCAYACgIAWwAAAAEAAAAAxmW3",
            "ygAAAADVVeemAAAAANVV7Dg=) format('woff')"
          ].join('')
        },
        ".MJX-VEC": {
          "font-family": "MJX-VEC"
        }
      }
    }
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
  <script src="https://deustotech.github.io/DyCon-Blog/js/clean-blog.min.js "></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128123935-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128123935-3');
  </script>
  <!-- End Google Analytics -->



  <!-- marKdown editor -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
  <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
</head>

<body>
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/DyCon-Blog/">
                 <img src="https://deustotech.github.io//DyCon-Blog//assets/logo_DyCon.png">
            </a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/DyCon-Blog/">Home</a>
                </li>
                
                
                    
                        
                    
                                   
                <li>
                    <a href="/DyCon-Blog/projects/posts">Documentation</a>
                </li>
                
                    
                
                    
                <li>
                        <a href="https://deustotech.github.io/DyCon-Blog/projects/search.byWP">Sitemap</a>
                </li>
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
                
            </ul>

        
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Post Header -->
<header class="intro-header">
  <div class="container" style="padding-top: 70px;">
    <div class="row">
      <div class="col-lg-10 col-md-10 col-md-offset-1">
        <div class="post-heading" style="padding: 0px 0"><h2><small class="light-grey"><a href="https://deustotech.github.io//DyCon-Blog/projects/posts">Work Packages</a>
            &#8827;<a href="https://deustotech.github.io//DyCon-Blog/workpackage/WP99">
            Other Topics</a> &#8827;</small>
          </h2>
          <h1>Two Grids Filter Method for RPS Semi-Discretization</h1>
					<p class="meta">
            <div class="post-preview-authors ellipsis-one-line">
              Author:
              
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/XinliangL">Xinliang Liu</a>
                  </span>
                </span>
              
              - 07 January 2019
            </div>
					</p>
        </div>
      </div>
		</div>
	</div>
</header>
<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>
<article>
  <div id="content" class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          
            <a href="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/P0002_Numerical_homogenizaton_for_wave_equation.zip""><i class="fa fa-download fa-lg"></i>Download Code</a>
          
        
        <p>This work is regarding solving 1-d wave equation using RPS semi-discretization method and analysis corresponding dispersion relation</p>

<p>Solving 1-d wave equation with RPS semi-discretization method Considering 1-d wave equation,</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation} 	\begin{cases} 	&u_{tt}- u_{xx} =0,  0\leq x\leq 1, t\in[0,T] \\ 	& u(x,T)=u_0(x),\, \, 0\leq x\leq 1, \\ 	& u_t(x,T)=u_1(x),\,\,0\leq x\leq 1,  \\ 	& u(0,t)=u(1,t)=0, \,\, t\in[0,T], 	\end{cases} 	\label{wave} 	\end{equation} %]]></script>

<p>When $(u_0,u_1) \in H_0^1(0,1)\times L^2(0,1)$, it admits a unique solution $u(x,t) \in C^0([0,T],H_0^1(0,1)) \cap C^1([0,T],L^2(0,1))$. 	The energy of solution to \eqref{wave} $E(t)$</p>

<script type="math/tex; mode=display">\begin{equation} 	E(t)=\frac{1}{2}\int_{0}^{1} \vert u_x(x,t) \vert^2+ \vert u_t(x,t)\vert^2 dx, 	\end{equation}</script>

<p>is time conserved .</p>

<p>With Hilbert Uniqueness Method, the exact controllability of \eqref{wave} is  equal to the observability of the adjoint \eqref{wave}, Observability of \eqref{wave} reads as: Given $T\geq 2$, there exist a positive constant $C(T)\geq 0$ such that</p>

<script type="math/tex; mode=display">\begin{equation}       E(0)\leq C(T) \int_{0}^{T} \vert u_x(1,t) \vert ^2 dt. \end{equation}</script>

<p>holds for every solution $u(x,t)$ to adjoint system \eqref{wave}</p>

<p>RPS semi-discretization of  weak variation formulation  of \eqref{wave} is written as</p>

<script type="math/tex; mode=display">\begin{equation} 	M \frac{d^2 \boldsymbol{u}}{dt^2}=-R\boldsymbol{u}, 	\label{fem_wave} 	\end{equation}</script>

<p>where $M_{i,j}:=\int_{-\infty}^{+\infty}\phi_i\phi_j dx$ and $R_{i,j}=\int_{-\infty}^{+\infty}\frac{d}{dx}\phi_i\frac{d}{dx}\phi_j dx $ and  the corresponding $\hat{A}(\omega)$ defined as</p>

<script type="math/tex; mode=display">\begin{equation}       \hat{A}(\omega)= \frac{R e^{i\omega x_n}}{M e^{i\omega x_n} }. 	\end{equation}</script>

<p>As for this problem, the rps basis $\phi_i(x)$ corresponding  $x_i$ is defined by</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation} 	\phi_i =\left\{ 	\begin{aligned} 	\arg &\min_{v \in H_0^2[-1,1]}  \int_{-1}^{1}(\frac{d^2}{dx^2} v)^2 dx  \\ 	&s.t.\  v(x_j) = \delta_{i,j},\ \ j = \{1,...,N\}, \\ 	\end{aligned} 	\right. 	\label{basis} 	\end{equation} %]]></script>

<p>Set up uniform fine mesh and coarse mesh</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">);</span> <span class="n">H</span><span class="o">=</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span> <span class="n">Nbasis</span><span class="o">=</span><span class="mi">2</span><span class="p">/</span><span class="n">H</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="p">/</span><span class="n">h</span><span class="p">;</span> <span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">/</span><span class="n">H</span><span class="p">;</span>
</code></pre>
</div>

<p>Construct the stiffness matrix and massive matrix regarding p1 finite element on fine mesh and coarse mesh respectively</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">L</span> <span class="o">=</span> <span class="nb">sparse</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)]);</span>
<span class="n">LL</span><span class="o">=</span> <span class="nb">sparse</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="o">-</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">4</span><span class="p">)]);</span>
<span class="n">M</span> <span class="o">=</span> <span class="nb">sparse</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">/</span><span class="mi">3</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">/</span><span class="mi">6</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">-</span><span class="mi">4</span><span class="p">)]);</span>
<span class="n">MM</span> <span class="o">=</span> <span class="nb">sparse</span><span class="p">([</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">/</span><span class="mi">3</span><span class="o">*</span><span class="n">H</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">/</span><span class="mi">6</span><span class="o">*</span><span class="n">H</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">-</span><span class="mi">4</span><span class="p">)]);</span>
<span class="n">L</span><span class="o">=</span><span class="mi">1</span><span class="p">/</span><span class="n">h</span><span class="o">*</span><span class="n">L</span><span class="p">;</span>
<span class="n">LL</span><span class="o">=</span><span class="mi">1</span><span class="p">/</span><span class="n">H</span><span class="o">*</span><span class="n">LL</span><span class="p">;</span>
</code></pre>
</div>

<p>Construct the discrete energy $\vert-div(a\nabla \cdot)\vert$</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">L</span><span class="p">(:,</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">boundary</span> <span class="o">=</span> <span class="n">L</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="k">end</span><span class="p">],</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">temp</span><span class="s1">'*temp+100*(boundary'</span><span class="p">)</span><span class="o">*</span><span class="n">boundary</span><span class="p">;</span>
</code></pre>
</div>

<p>Matrix corresponding  pointwise constrains</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">B</span> <span class="o">=</span> <span class="nb">eye</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">H</span><span class="p">/</span><span class="n">h</span><span class="o">*</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nbasis</span><span class="p">],:);</span>
</code></pre>
</div>

<p>Solve the rps basis by solving the optimization problems</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">Psi</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">Nbasis</span><span class="p">);</span>
<span class="k">for</span> <span class="nb">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">:</span><span class="nb">size</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ei</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">Nbasis</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">ei</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">Psi</span><span class="p">(:,</span><span class="nb">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">\(</span><span class="n">B</span><span class="s1">'*((B*inv(A)*B'</span><span class="p">)\</span><span class="n">ei</span><span class="p">));</span>
<span class="k">end</span>
</code></pre>
</div>

<p>plot the basis and log scale of basis</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">clf</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="nb">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Psi</span><span class="p">(:,</span><span class="mi">16</span><span class="p">))));</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">;</span><span class="n">Psi</span><span class="p">(:,</span><span class="mi">16</span><span class="p">);</span><span class="mi">0</span><span class="p">],</span><span class="s1">'b'</span><span class="p">);</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_01.png" alt="" /></p>

<p>Set up the time interval, time step, source term $f=0$</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">T</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">J</span><span class="o">=</span><span class="mi">10000</span><span class="p">;</span><span class="n">f</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">A</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
</code></pre>
</div>

<p>Set up the concentration parameter of inital data $\gamma$, frequency $\xi$ and generate fine grids $x$ and the initial data defined on them</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">gamma</span><span class="o">=</span><span class="n">H</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mf">1.8</span><span class="p">);</span> <span class="n">xi</span><span class="o">=</span><span class="mi">3</span><span class="p">/</span><span class="mi">4</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span> <span class="n">x</span><span class="o">=-</span><span class="mi">1</span><span class="o">+</span><span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="n">h</span><span class="p">;</span>
<span class="n">ui</span><span class="o">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="n">x</span><span class="p">/</span><span class="n">H</span><span class="p">);</span>
<span class="n">uti</span><span class="o">=-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="n">x</span><span class="p">/</span><span class="n">H</span><span class="p">)</span><span class="o">-</span><span class="n">xi</span><span class="p">/</span><span class="n">H</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="n">x</span><span class="p">/</span><span class="n">H</span><span class="p">);</span>
</code></pre>
</div>

<p>Solve the wave equation on fine mesh as a approximation of analytical solution, which will be used then as a reference of rps solution</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="n">ut</span><span class="p">]</span> <span class="o">=</span>  <span class="n">ODEsolver</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">ui</span><span class="p">,</span><span class="n">uti</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">M</span><span class="p">);</span>
<span class="p">[</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">h</span><span class="p">:</span><span class="n">h</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="n">h</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">T</span><span class="p">/</span><span class="n">J</span><span class="p">:</span><span class="n">T</span><span class="p">);</span>
<span class="nb">clf</span><span class="p">,</span> <span class="nb">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">u</span><span class="o">'</span><span class="p">)</span> <span class="p">;</span><span class="nb">shading</span> <span class="n">interp</span> <span class="p">;</span> <span class="nb">colorbar</span><span class="p">;</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'finemesh solution'</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_02.png" alt="" /></p>

<p>Solve the wave equation on coarsemesh using RPS method</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">xc</span><span class="o">=</span><span class="n">x</span><span class="p">(</span><span class="n">H</span><span class="p">/</span><span class="n">h</span><span class="o">*</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">Nbasis</span><span class="p">]);</span>
<span class="n">Mc</span><span class="o">=</span><span class="n">Psi</span><span class="s1">'*M*Psi; Lc=Psi'</span><span class="o">*</span><span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Psi</span><span class="p">;</span>
<span class="n">uci</span><span class="o">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="n">xc</span><span class="p">/</span><span class="n">H</span><span class="p">);</span>
<span class="n">utci</span><span class="o">=-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="nb">cos</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="n">xc</span><span class="p">/</span><span class="n">H</span><span class="p">)</span><span class="o">-</span><span class="n">xi</span><span class="p">/</span><span class="n">H</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">gamma</span><span class="o">*</span><span class="p">(</span><span class="n">xc</span><span class="p">)</span><span class="o">.^</span><span class="mi">2</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="nb">sin</span><span class="p">(</span><span class="n">xi</span><span class="o">*</span><span class="n">xc</span><span class="p">/</span><span class="n">H</span><span class="p">);</span>
<span class="n">fc</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">Lc</span><span class="p">),</span><span class="mi">1</span><span class="p">);</span>
<span class="p">[</span><span class="n">uc</span><span class="p">,</span><span class="n">uct</span><span class="p">]</span><span class="o">=</span><span class="n">ODEsolver</span><span class="p">(</span><span class="n">Mc</span><span class="p">,</span><span class="n">Lc</span><span class="p">,</span><span class="n">uci</span><span class="p">,</span><span class="n">utci</span><span class="p">,</span><span class="n">fc</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">Mc</span><span class="p">);</span>
<span class="nb">clf</span><span class="p">,</span> <span class="nb">pcolor</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,(</span><span class="n">Psi</span><span class="o">*</span><span class="n">uc</span><span class="p">)</span><span class="o">'</span><span class="p">);</span><span class="nb">shading</span> <span class="n">interp</span> <span class="p">;</span> <span class="nb">colorbar</span><span class="p">;</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'coarsemesh solution with rps basis'</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_03.png" alt="" /></p>

<p>Solve the wave equation on coarsemesh using p1 fem</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="p">[</span><span class="n">uuc</span><span class="p">,</span><span class="n">uuct</span><span class="p">]</span><span class="o">=</span><span class="n">ODEsolver</span><span class="p">(</span><span class="n">MM</span><span class="p">,</span><span class="n">LL</span><span class="p">,</span><span class="n">uci</span><span class="p">,</span><span class="n">utci</span><span class="p">,</span><span class="n">fc</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="n">MM</span><span class="p">);</span>
<span class="p">[</span><span class="n">XX</span><span class="p">,</span><span class="n">YY</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">H</span><span class="p">:</span><span class="n">H</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="n">H</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="n">T</span><span class="p">/</span><span class="n">J</span><span class="p">:</span><span class="n">T</span><span class="p">);</span>
<span class="nb">clf</span><span class="p">,</span> <span class="nb">pcolor</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span><span class="n">uuc</span><span class="o">'</span><span class="p">);</span> <span class="nb">shading</span> <span class="n">interp</span> <span class="p">;</span> <span class="nb">colorbar</span><span class="p">;</span>
<span class="nb">title</span><span class="p">(</span><span class="s1">'coarsemesh solution with linear basis'</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_04.png" alt="" /></p>

<p><strong>Plot the disperation relation of RPS-semi descretization</strong></p>

<p>RPS semi-discretization of  weak variation formulation  of \eqref{wave} is written as</p>

<script type="math/tex; mode=display">\begin{equation}    M \frac{d^2 \boldsymbol{u}}{dt^2}=-R\boldsymbol{u} \end{equation}</script>

<p>where $M_{i,j}:=\int_{-\infty}^{+\infty}\phi_i\phi_j dx$ and $R_{i,j}=\int_{-\infty}^{+\infty}\frac{d}{dx}\phi_i\frac{d}{dx}\phi_j dx $ and the corresponding $\hat{A}(\omega)$ defined as</p>

<script type="math/tex; mode=display">\begin{equation} \hat{A}(\omega)= \frac{R e^{i\omega x_n}}{M e^{i\omega x_n} }. 	\end{equation}</script>

<p>Since thereâ€™s no explicit formulation for matrix $M$ and $R$, We can only calculate the fourier symbol of $M$ and $R$ numerically. Assuming the matrix $M$ is symmetric and toplitze and dimension $N$ of $M$ being a odd number, then fourier symbol of $M$   could be written as</p>

<script type="math/tex; mode=display">\begin{equation} \hat{M}(\omega)= M_{(N+1)/2,(N+1)/2}-2\sum_{i=1}^{(N+1)/2-1}M_{(N+1)/2,i}cos(i\omega h ),\ \omega h = 0,\frac{1}{N+1}\pi,..., 2\pi. \end{equation}</script>

<p>For example, let $M$  be mass matrix corresponding p1 finite element semi-descretization. the fourier symbol of $M$ is</p>

<script type="math/tex; mode=display">\begin{equation} \hat{M}(\omega)=2/3+1/3cos(\omega h)  \end{equation}</script>

<p>Construct the discrete $cos(i\omega h)$ with $\omega h$ sampled at 1000 points at interval $[0,2\pi]$</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="nb">cell</span><span class="p">(</span><span class="n">N</span><span class="p">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">f</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">for</span> <span class="nb">i</span> <span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">f</span><span class="p">{</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="o">@</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="mi">2</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
<span class="k">end</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">flip</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>

<span class="n">Matrix_cos</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
<span class="k">for</span> <span class="nb">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">/</span><span class="mi">2</span>
    <span class="n">xx</span><span class="o">=</span><span class="nb">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">,</span><span class="mi">1000</span><span class="p">);</span>
    <span class="n">Matrix_cos</span><span class="p">(</span><span class="nb">i</span><span class="p">,:)</span><span class="o">=</span><span class="nb">arrayfun</span><span class="p">(</span><span class="n">f</span><span class="p">{</span><span class="nb">i</span><span class="p">},</span><span class="n">xx</span><span class="p">);</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Calculate the fourier symbol of $M$ and $R$</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">M_symbol</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">H</span><span class="o">*</span><span class="n">Mc</span><span class="p">(</span><span class="mi">1</span><span class="p">/</span><span class="n">H</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix_cos</span><span class="p">;</span>
<span class="n">R_symbol</span> <span class="o">=</span> <span class="n">H</span><span class="o">*</span><span class="n">Lc</span><span class="p">(</span><span class="mi">1</span><span class="p">/</span><span class="n">H</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Matrix_cos</span><span class="o">.</span><span class="p">/</span><span class="n">xx</span><span class="o">.^</span><span class="mi">2</span><span class="p">;</span>
</code></pre>
</div>

<p>Plot the numerical phase velocity for sinusoidal solution and compare it with the ones for FDM and FEM</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">hold</span> <span class="n">on</span>
<span class="n">phaseVelocity</span> <span class="o">=</span> <span class="n">R_symbol</span><span class="o">.^</span><span class="p">(</span><span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="p">/</span><span class="n">M_symbol</span><span class="o">.^</span><span class="p">(</span><span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">clf</span><span class="p">,</span> <span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">phaseVelocity</span><span class="p">)</span>
<span class="c1">%% for p1 FEM</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">p1PhaseV</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">xx</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="p">/</span><span class="n">xx</span><span class="o">*</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="p">/</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span><span class="o">.^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">p1PhaseV</span><span class="p">)</span>
<span class="c1">%% for FDM</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">fdmPhaseV</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">xx</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="p">/</span><span class="n">xx</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">fdmPhaseV</span><span class="p">)</span>
<span class="c1">%%</span>
<span class="n">ax</span><span class="o">=</span><span class="nb">gca</span><span class="p">;</span> <span class="n">ax</span><span class="o">.</span><span class="n">XTick</span> <span class="o">=</span> <span class="p">([</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span> <span class="mi">5</span><span class="p">/</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span> <span class="nb">pi</span> <span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XTickLabel</span> <span class="o">=</span><span class="p">({</span><span class="s1">'0'</span><span class="p">,</span><span class="s1">'1/2\pi'</span><span class="p">,</span><span class="s1">'5/6*\pi'</span><span class="p">,</span><span class="s1">'\pi'</span><span class="p">,</span><span class="s1">'2\pi'</span><span class="p">});</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'\omega*H'</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'RPS'</span><span class="p">,</span><span class="s1">'P1 FEM'</span><span class="p">,</span><span class="s1">'FDM'</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_05.png" alt="" /></p>

<p>Plot the numerical group velocity for sinusoidal solution and compare it with the ones for FDM and FEM</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">groupVelocity</span> <span class="o">=</span> <span class="nb">diff</span><span class="p">(</span><span class="n">phaseVelocity</span><span class="p">)/((</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)/</span><span class="mi">999</span><span class="p">)</span><span class="o">.*</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">phaseVelocity</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">clf</span><span class="p">,</span> <span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">groupVelocity</span><span class="p">)),</span><span class="n">groupVelocity</span><span class="p">)</span>
<span class="c1">%% for p1 FEM</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">p1GroupV</span> <span class="o">=</span> <span class="nb">diff</span><span class="p">(</span><span class="n">p1PhaseV</span><span class="p">)/((</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)/</span><span class="mi">999</span><span class="p">)</span><span class="o">.*</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">p1PhaseV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">p1GroupV</span><span class="p">)</span>
<span class="c1">%% for FDM</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="n">fdmGroupV</span> <span class="o">=</span> <span class="nb">diff</span><span class="p">(</span><span class="n">fdmPhaseV</span><span class="p">)/((</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">-</span><span class="mf">0.1</span><span class="p">)/</span><span class="mi">999</span><span class="p">)</span><span class="o">.*</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">groupVelocity</span><span class="p">))</span><span class="o">+</span><span class="n">fdmPhaseV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">groupVelocity</span><span class="p">));</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">groupVelocity</span><span class="p">)),</span><span class="n">fdmGroupV</span><span class="p">)</span>
<span class="c1">%% for ecact group velocity</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="nb">ones</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">xx</span><span class="p">)),</span><span class="s1">'LineStyle'</span><span class="p">,</span><span class="s1">'--'</span><span class="p">)</span>
<span class="c1">%%</span>
<span class="n">ax</span><span class="o">=</span><span class="nb">gca</span><span class="p">;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XTick</span><span class="o">=</span><span class="p">([</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span> <span class="mi">5</span><span class="p">/</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span> <span class="nb">pi</span> <span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XTickLabel</span> <span class="o">=</span><span class="p">({</span><span class="s1">'0'</span><span class="p">,</span><span class="s1">'1/2\pi'</span><span class="p">,</span><span class="s1">'5/6*\pi'</span><span class="p">,</span><span class="s1">'\pi'</span><span class="p">,</span><span class="s1">'2\pi'</span><span class="p">});</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XLim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="nb">pi</span><span class="p">];</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'\omega*H'</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'RPS'</span><span class="p">,</span><span class="s1">'P1 FEM'</span><span class="p">,</span><span class="s1">'FDM'</span><span class="p">,</span><span class="s1">'exact'</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_06.png" alt="" /></p>

<p>Plot the numerical disperation relation Disperation relation for RPS semi-discretizaton</p>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="n">diperss</span> <span class="o">=</span> <span class="n">phaseVelocity</span><span class="o">.*</span><span class="n">xx</span><span class="p">;</span>
</code></pre>
</div>

<div class="language-matlab highlighter-rouge"><pre class="highlight"><code><span class="nb">clf</span>
<span class="nb">hold</span> <span class="n">on</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">diperss</span><span class="p">)</span>
<span class="c1">%% for P1 FEM</span>
<span class="nb">hold</span> <span class="n">on</span><span class="p">,</span> <span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">xx</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="mi">2</span><span class="p">/</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span><span class="o">.^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="p">));</span>
<span class="c1">%% for FDM</span>
<span class="nb">hold</span> <span class="n">on</span> <span class="p">,</span> <span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="p">/</span><span class="mi">2</span><span class="p">))</span>
<span class="c1">%% for exact one</span>
<span class="nb">hold</span> <span class="n">on</span> <span class="p">,</span> <span class="nb">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="s1">'LineStyle'</span><span class="p">,</span><span class="s1">'--'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span><span class="nb">gca</span><span class="p">;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XTick</span><span class="o">=</span><span class="p">([</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span> <span class="mi">5</span><span class="p">/</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span> <span class="nb">pi</span> <span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">]);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XTickLabel</span> <span class="o">=</span><span class="p">({</span><span class="s1">'0'</span><span class="p">,</span><span class="s1">'1/2\pi'</span><span class="p">,</span><span class="s1">'5/6*\pi'</span><span class="p">,</span><span class="s1">'\pi'</span><span class="p">,</span><span class="s1">'2\pi'</span><span class="p">});</span>
<span class="n">ax</span><span class="o">.</span><span class="n">XLim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span> <span class="nb">pi</span><span class="p">];</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s1">'\omega*H'</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="s1">'RPS'</span><span class="p">,</span><span class="s1">'P1 FEM'</span><span class="p">,</span><span class="s1">'FDM'</span><span class="p">,</span><span class="s1">'exact'</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0002-Numerical homogenizaton/copiaRM_07.png" alt="" /></p>

        <hr>
      </div>
    </div>
  </div>
  <div id="content" class="container">

  <div class="relatedPosts">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
    <h2>Related Posts</h2>
    
    
    
    
    

    
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP99/P0010/MEMSgif2.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp99/P0010" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Touchdown localization for the MEMS problem with variable dielectric permittivity </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this tutorial we study the localization of touchdown points in a mathematical model for micro-electro-mechanical systems (MEMS) with variable dielectric permittivity. We consider a device consisting of two conducting plates, connected to an electric circuit. The upper plate is rigid and fixed while the lower one is elastic and fixed only at the boundary. When a voltage (difference of potential between the two plates) is applied, the lower plate starts to bend and, if the voltage is large enough, the lower plate eventually touches the upper one. This is called touchdown phenomenon and our aim is to control the localization of touchdown points in the device by a suitable choice of the dielectric permittivity of the material.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/CarlosE">Carlos Esteve</a>
          
          - 30 September 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP99/P0008/animation.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp99/P0008" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Propagation of one and two-dimensional discrete waves under finite difference approximation </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      We analyze the propagation properties of the numerical versions of one and two-dimensional wave equations, semi-discretized in space by finite difference schemes, and we illustrate that numerical solutions may have unexpected behaviours with respect to the analytic ones.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Authors:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/UmbertoB">Umberto Biccari</a>,
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/JesusO">Jesus Oroya</a>
          
          - 26 June 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP99/P0007/p0018_50.png">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp99/P0007" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Structured deformations of continua </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      A Multiscale Geometrical Basis for Variational Problems in Mechanics
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Authors:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/MarcoM">Marco Morandotti</a>,
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/JoseM">Jose Matias</a>
          
          - 26 March 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn  btn-sm" style="margin-left: auto;"></button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://cmc.deusto.eus/wp-content/uploads/2019/02/levet-set.png">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp99/P0006" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> An introduction to the moment method for optimal control problems for polynomial ODEs </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      The aim of this note is to explain how one can solve an optimal control problem with the moment method
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/SwannM">Swann MARX</a>
          
          - 04 February 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
            
    </div>
  </div> 
    </div>
  </div>

</article>
<hr>

    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <ul class="list-inline text-center">
        <li style="margin-right: 50px;">
          <img style="width: 250px;" src="/DyCon-Blog/img/logos/logo_DyCon.png " alt="">
        </li>
        <li style="padding-bottom: 5px;">
          <img style="width: 230px;" src="/DyCon-Blog/img/logos/logo_CCM_subDerecha_v002.png " alt="">
        </li>
      </ul>
    </div>
  </div>
</footer>

</body>
</html>
