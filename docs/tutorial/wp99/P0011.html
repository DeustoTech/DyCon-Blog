<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">
	<link rel='shortcut icon' type='image/png' href='/DyCon-Blog/favicon.png' />

  <title>
    Stability analysis of Power Electronic Converters Connected to AC Grids - DyCon Blog
    
  </title>

  <link rel="canonical" href="https://deustotech.github.io/DyCon-Blog/tutorial/wp99/P0011">

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/clean-blog.css">

   <!-- Adjust Colors -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/colorscheme.css">

  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/syntax.css">

  <!-- Google Fonts Raleway -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
	<!-- MathJax -->
	<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
            equationNumbers: {
                                autoNumber: "AMS"
            },
            extensions: ["AMSmath.js", "AMSsymbols.js"],
        Macros:{
            norm: ["|| #1 ||",1],
            abs: ["| #1 |",1],
            hdots: "...",
            RR: "\\mathbb{R}",
            ffl: ["(d_x^2)^{#1}",1],
            ccs: "c_{1,s}",
            kernel: ["|x-y|^{#1}",1],
            ue: ["#1^{\\epsilon}",1]
            }
        },
    /*CommonHTML: {
      scale: 300
    }*/
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>

	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
    <script src="https://deustotech.github.io/DyCon-Blog/js/clean-blog.min.js "></script>

 	<!-- 404  JavaScript -->

</head>

<body>
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/DyCon-Blog/">
                 <img src="https://deustotech.github.io//DyCon-Blog//assets/logo_DyCon.png">
            </a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/DyCon-Blog/">Home</a>
                </li>
                
                
                <li>
                    <a href="/DyCon-Blog/projects/posts">Documentation</a>
                </li>
                
                <li>
                    <a href="/DyCon-Blog/projects/authors">Authors</a>
                </li>
                
                <li>
                    <a href="/DyCon-Blog/projects/search">Web Sitemap</a>
                </li>
                
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Post Header -->
<header class="intro-header">
  <div class="container" style="padding-top: 70px;">
    <div class="row">
      <div class="col-lg-10 col-md-10 col-md-offset-1">
        <div class="post-heading" style="padding: 0px 0"><h2><small class="light-grey"><a href="https://deustotech.github.io//DyCon-Blog/projects/posts">Work Packages</a>
            &#8827;<a href="https://deustotech.github.io//DyCon-Blog/workpackage/WP99">
            Other Topics</a> &#8827;</small>
          </h2>
          <h1>Stability analysis of Power Electronic Converters Connected to AC Grids</h1>
					<p class="meta">
            <div class="post-preview-authors ellipsis-one-line">
              Authors:
              
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/UmbertoB">Umberto Biccari</a>,
                  </span>
                </span>
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/JesusO">Jesus Oroya</a>
                  </span>
                </span>
              
              - 15 November 2018
            </div>
					</p>
        </div>
      </div>
		</div>
	</div>
</header>
<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>
<article>
  <div id="content" class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          
            <a href="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP99/P0011/Stability_analysis_of_Power_Electronic.zip""><i class="fa fa-download fa-lg"></i>Download Code</a>
          
        
        <p>We analyze the stability of a simplified system modeling two converters in parallel connected to an ideal grid (modelled by a voltage source) via line impedances.</p>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP99/P0011/converters.png" alt="" /></p>

<p>Each of the converters is fed by a DC source and includes an $LC$ circuit at its output to filter the ripple introduced by the converter switching. Similarly, an $LR$ impedance is included after the $LC$ filter to model the characteristics of the line until the point of common connection (PCC). The grid in this case is modelled with an ideal voltage source $v_g$ with a series $LR$ impedance. In this context, $f$ subscript denotes filter and $o$ subscript denotes output of the inverter. The subscript %%g%% denotes that this variable is from the side of the grid.</p>

<p>The dynamics inside the system (e.g. how does the current in an inductor or the voltage in a capacitor evolve over time) is described by several differential equations describing the evolution of the state input vector. The model is then completed with the introduction of algebraic relations which link the previous equations by applying classical laws such as Kirchoff.</p>

<p>All these equations depend on some parameters characteristic of the physical model:</p>

<ul>
  <li>
    <p>$Rf_{1}$ and $Rf_{2}$: the filter resistors;</p>
  </li>
  <li>
    <p>$Lf_{1}$ and $Lf_{2}$: the inductances of the filter;</p>
  </li>
  <li>
    <p>$Cf_{1}$ and $Cf_{2}$: the capacitances;</p>
  </li>
  <li>
    <p>$Ro_{1}$ and $Ro_{2}$: the output resistors;</p>
  </li>
  <li>
    <p>$Lo_{1}$ and $Lo_{2}$: the output inductances;</p>
  </li>
  <li>
    <p>$Rg$: the grid resistor;</p>
  </li>
  <li>
    <p>$Lg$: the grid inductance.</p>
  </li>
</ul>

<p>The model is then written in the form $\dot{x} = Ax + Bu$, with</p>

<script type="math/tex; mode=display">% <![CDATA[
A = \left(\begin{array}{ccccccc} -\frac{\mathrm{Rf}_{1}}{\mathrm{Lf}_{1}} & -\frac{1}{\mathrm{Lf}_{1}} & 0 & 0 & 0 & 0 & 0\\ \frac{1}{\mathrm{Cf}_{1}} & 0 & -\frac{1}{\mathrm{Cf}_{1}} & 0 & 0 & 0 & 0\\ 0 & -\frac{\frac{1}{L\,\mathrm{Lo}_{1}}-1}{\mathrm{Lo}_{1}} & \frac{\mathrm{Ro}_{1}\,\left(\frac{1}{L\,\mathrm{Lo}_{1}}-1\right)}{\mathrm{Lo}_{1}} & 0 & -\frac{1}{L\,\mathrm{Lo}_{1}\,\mathrm{Lo}_{2}} & \frac{\mathrm{Ro}_{2}}{L\,\mathrm{Lo}_{1}\,\mathrm{Lo}_{2}} & \frac{\mathrm{Ro}_{2}}{L\,\mathrm{Lg}\,\mathrm{Lo}_{1}}\\ 0 & 0 & 0 & -\frac{\mathrm{Rf}_{2}}{\mathrm{Lf}_{2}} & -\frac{1}{\mathrm{Lf}_{2}} & 0 & 0\\ 0 & 0 & 0 & \frac{1}{\mathrm{Cf}_{2}} & 0 & -\frac{1}{\mathrm{Cf}_{2}} & 0\\ 0 & -\frac{1}{L\,\mathrm{Lo}_{1}\,\mathrm{Lo}_{2}} & \frac{\mathrm{Ro}_{1}}{L\,\mathrm{Lo}_{1}\,\mathrm{Lo}_{2}} & 0 & -\frac{\frac{1}{L\,\mathrm{Lo}_{2}}-1}{\mathrm{Lo}_{2}} & \frac{\mathrm{Ro}_{2}\,\left(\frac{1}{L\,\mathrm{Lo}_{2}}-1\right)}{\mathrm{Lo}_{2}} & -\frac{\mathrm{Rg}}{L\,\mathrm{Lg}}\\ 0 & \frac{1}{L\,\mathrm{Lg}\,\mathrm{Lo}_{1}} & -\frac{\mathrm{Ro}_{1}}{L\,\mathrm{Lg}\,\mathrm{Lo}_{1}} & 0 & \frac{\mathrm{Ro}_{1}}{L\,\mathrm{Lg}\,\mathrm{Lo}_{2}} & -\frac{\mathrm{Ro}_{2}}{L\,\mathrm{Lg}\,\mathrm{Lo}_{2}} & \frac{\mathrm{Rg}\,\left(\frac{1}{L\,\mathrm{Lg}}-1\right)}{\mathrm{Lg}} \end{array}\right) %]]></script>

<script type="math/tex; mode=display">% <![CDATA[
B =   \left(\begin{array}{ccc} \frac{m_{1}}{\mathrm{Lf}_{1}} & 0 & 0\\ 0 & 0 & 0\\ 0 & 0 & -\frac{1}{L\,\mathrm{Lg}\,\mathrm{Lo}_{1}}\\ 0 & \frac{m_{2}}{\mathrm{Lf}_{2}} & 0\\ 0 & 0 & 0\\ 0 & 0 & 0\\ 0 & 0 & 0 \end{array}\right) %]]></script>

<p>and $u = [Vdc_{1} Vdc_{2} V_{g}]$. here we defined</p>

<script type="math/tex; mode=display">L=\left(Lo_{1}^{-1}+Lo_{2}^{-1}+Lg^{-1}\right)</script>

<p>The stability of the system is discussed by studying the evolution of the eigenvalues of $A$ in dependence of the aforementioned parameters. Due to the size of the system and to the large number of parameters involved, this stability analysis needs to be addressed by means of fine computational tools.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">clear</span>
</code></pre></div></div>

<h2 id="variables-composing-the-state-vector">Variables composing the state vector</h2>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">syms</span> <span class="n">Ii1</span> <span class="n">Vo1</span> <span class="n">Io1</span> <span class="n">Ii2</span> <span class="n">Vo2</span> <span class="n">Io2</span> <span class="n">Ig</span>
</code></pre></div></div>

<h2 id="parameters-entering-in-the-model">Parameters entering in the model</h2>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">syms</span> <span class="n">Ro1</span> <span class="n">Rf1</span> <span class="n">Lf1</span> <span class="n">Cf1</span> <span class="n">Lo1</span>
<span class="n">syms</span> <span class="n">Ro2</span> <span class="n">Rf2</span> <span class="n">Lf2</span> <span class="n">Cf2</span> <span class="n">Lo2</span>
<span class="n">syms</span> <span class="n">Rg</span> <span class="n">Lg</span> <span class="n">L</span>
<span class="c1">%% sustituimos numericamente excepto nRo1 syms m1 m2</span>
</code></pre></div></div>

<p>Out of these parameters, we build the matrices $A$ and $B$ in symbolic form.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">Amatrix</span><span class="p">();</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">Bmatrix</span><span class="p">();</span>
</code></pre></div></div>

<p>We now want to study the evolution of the eigenvalues with respect to $\mathrm{Ro}_{1}$. Thus, we assign some fix value to all the others parameters</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nRf1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nLf1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nCf1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nLo1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">nRo2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nRf2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nLf2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nCf2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">nLo2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nRg</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nLg</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">nL</span> <span class="o">=</span> <span class="mi">1</span><span class="p">/</span><span class="n">nLo1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">/</span><span class="n">nLo2</span> <span class="p">;</span>
</code></pre></div></div>

<p>and we build the corresponding matrix $A$, which will depend only on $Ro_{1}$.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">symbolic</span>  <span class="o">=</span> <span class="p">[</span><span class="n">Rf1</span><span class="p">,</span> <span class="n">Lf1</span><span class="p">,</span> <span class="n">Cf1</span><span class="p">,</span> <span class="n">Lo1</span><span class="p">,</span> <span class="k">...</span>
             <span class="n">Ro2</span><span class="p">,</span>  <span class="n">Rf2</span><span class="p">,</span> <span class="n">Lf2</span><span class="p">,</span> <span class="n">Cf2</span><span class="p">,</span> <span class="n">Lo2</span><span class="p">,</span> <span class="k">...</span>
             <span class="n">Rg</span><span class="p">,</span>   <span class="n">Lg</span><span class="p">,</span>  <span class="n">L</span><span class="p">];</span>

<span class="n">numerical</span> <span class="o">=</span> <span class="p">[</span><span class="n">nRf1</span><span class="p">,</span> <span class="n">nLf1</span><span class="p">,</span> <span class="n">nCf1</span><span class="p">,</span> <span class="n">nLo1</span><span class="p">,</span> <span class="k">...</span>
             <span class="n">nRo2</span><span class="p">,</span>  <span class="n">nRf2</span><span class="p">,</span> <span class="n">nLf2</span><span class="p">,</span> <span class="n">nCf2</span><span class="p">,</span> <span class="n">nLo2</span><span class="p">,</span> <span class="k">...</span>
             <span class="n">nRg</span><span class="p">,</span>   <span class="n">nLg</span><span class="p">,</span>  <span class="n">nL</span><span class="p">];</span>
<span class="n">nA</span> <span class="o">=</span> <span class="n">subs</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">symbolic</span><span class="p">,</span><span class="n">numerical</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 
nA =
 
[ -1,   -1,      0,  0,     0,    0,    0]
[  1,    0,     -1,  0,     0,    0,    0]
[  0,  1/2, -Ro1/2,  0,  -1/2,  1/2,  1/2]
[  0,    0,      0, -1,    -1,    0,    0]
[  0,    0,      0,  1,     0,   -1,    0]
[  0, -1/2,  Ro1/2,  0,   1/2, -1/2, -1/2]
[  0,  1/2, -Ro1/2,  0, Ro1/2, -1/2, -1/2]
 

</code></pre></div></div>

<p>Then, we convert it from symbolic to function_handle</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">funRo1</span> <span class="o">=</span> <span class="n">matlabFunction</span><span class="p">(</span><span class="nb">eig</span><span class="p">(</span><span class="n">nA</span><span class="p">));</span>
</code></pre></div></div>

<p>Finally, we compute and plot the eigenvalues of this matrix $A$ and we analyze their evolution while varying $Ro_{1}$ in a given range.</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">nRo1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="mf">0.05</span><span class="p">:</span><span class="mi">5</span><span class="p">;</span>
<span class="n">eigenvalues</span> <span class="o">=</span> <span class="nb">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">nRo1</span><span class="p">));</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">inRo1</span> <span class="o">=</span> <span class="n">nRo1</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="c1">%% in each iteration we replace in funRo1 a different value of the parameter</span>
    <span class="n">eigenvalues</span><span class="p">{</span><span class="n">index</span><span class="p">}</span> <span class="o">=</span> <span class="n">funRo1</span><span class="p">(</span><span class="n">inRo1</span><span class="p">);</span>
<span class="k">end</span>
</code></pre></div></div>

<p>For each value of $Ro_{1}$, the eigenvalues are stored in a cell. For instance, these are the eigenvalues corresponding to $Ro_{1}=-3$</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eigenvalues</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
ans =

  -1.0000 + 0.0000i
   0.0000 + 0.0000i
  -0.5000 - 0.8660i
  -0.5000 + 0.8660i
   0.0000 + 0.0000i
   0.2500 - 0.6614i
   0.2500 + 0.6614i


</code></pre></div></div>

<p>We then use use the Matlab program “EingEvolution” that we specifically degsigned, in order to see the evolution of these eigenvalues. This is done through the command <code class="highlighter-rouge">EingEvolution(autovalues,nRo1,'R_{o1}','Gif_evo_eig.gif')</code>.</p>

<p>Finally, we can plot the evolution of the eigenvalues as a function of $R_{o_1}$.</p>

<p><img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP99/P0011/Gif_evo_eig.gif" alt="" /></p>

<p>This procedure may be repeated for all the others parameters, thus obtaining a complete stability analysis of our model.</p>


        <hr>
      </div>
    </div>
  </div>
</article>
<hr>

    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <ul class="list-inline text-center">
        <li style="margin-right: 50px;">
          <img style="width: 250px;" src="/DyCon-Blog/img/logos/logo_DyCon.png " alt="">
        </li>
        <li style="padding-bottom: 5px;">
          <img style="width: 230px;" src="/DyCon-Blog/img/logos/logo_CCM_subDerecha_v002.png " alt="">
        </li>
      </ul>
    </div>
  </div>
</footer>

</body>
</html>
