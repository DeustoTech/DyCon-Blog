<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">
	<link rel='shortcut icon' type='image/png' href='/DyCon-Blog/favicon.png' />

  <title>
    Conservation laws in the presence of shocks - DyCon Blog
    
  </title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="canonical" href="https://deustotech.github.io/DyCon-Blog/tutorial/wp04/P0002">

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/clean-blog.css">

   <!-- Adjust Colors -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/colorscheme.css">

  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/syntax.css">

  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/google-search.css">


  
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/libgif.js "></script>
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/rubbable.js "></script>


  <!-- Google Fonts Raleway -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
	<!-- MathJax -->
  <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      },
      extensions: ["AMSmath.js", "AMSsymbols.js"],
      Macros:{
        norm: ["|| #1 ||",1],
        abs: ["| #1 |",1],
        hdots: "...",
        RR: "\\mathbb{R}",
        ffl: ["(d_x^2)^{#1}",1],
        ccs: "c_{1,s}",
        kernel: ["|x-y|^{#1}",1],
        ue: ["#1^{\\epsilon}",1]
      }
    },
    CommonHTML: {
      styles: {
        "@font-face /* vec */ ": {
          "font-family": "MJX-VEC",
          src: [
            "url(data:application/x-font-woff;charset=utf-8;base64,",
            "d09GRgABAAAAAARMAA0AAAAABiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEMAAAABwA",
            "AAAccRGLqUdERUYAAAQMAAAAJAAAACgANAAmT1MvMgAAAaAAAABJAAAAYFc5gfFjbWFwAAACAAAA",
            "AEYAAAFKQxjlbWdhc3AAAAQEAAAACAAAAAj//wADZ2x5ZgAAAlQAAACUAAAAlIQU9HBoZWFkAAAB",
            "MAAAADAAAAA2C748e2hoZWEAAAFgAAAAHgAAACQFXQDqaG10eAAAAewAAAAUAAAAFAYvAE9sb2Nh",
            "AAACSAAAAAwAAAAMACgAcm1heHAAAAGAAAAAHQAAACAASQAmbmFtZQAAAugAAADxAAAB5uwlD0hw",
            "b3N0AAAD3AAAACgAAAA34M9aEXjaY2BkYGAA4uOfgq7G89t8ZeBmfgEUYbga+icNTssClVxnOgXk",
            "cjAwgUQBdqEMW3jaY2BkYGBu+feBgYHxCwMQMF5nYGRABawAcaQESgAAeNpjYGRgYGBlUGZgYgAB",
            "EMnIABJzAPMZAAZZAHAAAAB42mNgYSxn/MLAysDA1MW0h4GBoQdCMz5gMGRkAooysDEzwAAjECvA",
            "OAFprikMBxgUFCcxt/z7wMDA3MIoAFUDAwoMjACD8Qv5AAAAAfQAMgAAAAABTQAAAPoAAAH0AB14",
            "2mNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYFBQn/f8P5IPp/4/vFUHVAwEjGwOcw8gEJJgY",
            "UAEjxIrhDACLGwmnAAAAAAAUABQAFAAUAEoAAgAyAAABwgIVAAMABwAAMxEhESUhESEyAZD+ogEs",
            "/tQCFf3rMgGxAAEAHQIEAdcCygAiAAABNDYzMhcWFxYXFhUUBgcGBw4DIyImNTQ3IycmNTQ3ISYB",
            "eQsJBwUFBQofCwYLKyACBwMGBAcNL6urDQ0BZxgCtggMBQQPJRQHCwkGBhYpAgkCAgsJEygBCQoH",
            "DSYAeNqVjrGKwkAURe/EGBBUrG12CishMrFQcDuLsAi26YMOmsIMxAh+hN8i+CF+gd+y4B3zttjC",
            "woHhncu7774HoI8rFP5eIKzQw5dwgAjfwi2McBEO6bkLtzHAr3CEnhrTqcKOpDasMCQ1HKCLWLiF",
            "HyyFQ3puwm1oPIQjDFXfR62Ro8YeK9YzMlhsqB0qtvJ6v8rPmd3Uzkv2tihwwoHCbosTa0pryYH0",
            "NbKjRWPB/z626Se8dsY/hSHPGeTKOnXVzuqF/reYOoln8dQk80+u9b0KR97rD9Rc4xdNXtVQI7PV",
            "sXClNiaZGGP0B+FPMN1KMAAAAHjaY2BiAIP/zQxGDNgAKxAzMjAxMDMycSUWFeWXF2WmZ5QAAGh5",
            "BhgAAAAB//8AAnjaY2BkYGDgA2IJBgUgycTAyMDMwAIkWcA8BgZGCAYACgIAWwAAAAEAAAAAxmW3",
            "ygAAAADVVeemAAAAANVV7Dg=) format('woff')"
          ].join('')
        },
        ".MJX-VEC": {
          "font-family": "MJX-VEC"
        }
      }
    }
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
  <script src="https://deustotech.github.io/DyCon-Blog/js/clean-blog.min.js "></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128123935-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128123935-3');
  </script>
  <!-- End Google Analytics -->



  <!-- marKdown editor -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
  <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
</head>

<body>
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/DyCon-Blog/">
                 <img src="https://deustotech.github.io//DyCon-Blog//assets/logo_DyCon.png">
            </a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/DyCon-Blog/">Home</a>
                </li>
                
                
                    
                        
                    
                                   
                <li>
                    <a href="/DyCon-Blog/projects/posts">Documentation</a>
                </li>
                
                    
                
                    
                <li>
                        <a href="https://deustotech.github.io/DyCon-Blog/projects/search.byWP">Sitemap</a>
                </li>
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
                
            </ul>

        
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Post Header -->
<header class="intro-header">
  <div class="container" style="padding-top: 70px;">
    <div class="row">
      <div class="col-lg-10 col-md-10 col-md-offset-1">
        <div class="post-heading" style="padding: 0px 0"><h2><small class="light-grey"><a href="https://deustotech.github.io//DyCon-Blog/projects/posts">Work Packages</a>
            &#8827;<a href="https://deustotech.github.io//DyCon-Blog/workpackage/WP04">
            Inverse design of time-irreversible models</a> &#8827;</small>
          </h2>
          <h1>Conservation laws in the presence of shocks</h1>
					<p class="meta">
            <div class="post-preview-authors ellipsis-one-line">
              Authors:
              
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/RodrigoL">Rodrigo Lecaros</a>,
                  </span>
                </span>
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/EnriqueZ">Enrique Zuazua</a>
                  </span>
                </span>
              
              - 05 June 2017
            </div>
					</p>
        </div>
      </div>
		</div>
	</div>
</header>
<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>
<article>
  <div id="content" class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
        <h3>The problem</h3>
<p>We analyze a model tracking problem for a 1D scalar conservation law. It consists in optimizing the initial datum so to minimize a weighted distance to a given target during a given finite time horizon. To be more precise, given a finite time $T &gt; 0$,  a target function $u^d\in L^2(\mathbb R\times(0,T))$, and a positive weight  function $\rho\in L^\infty(\mathbb R\times(0,T))$ with compact support in $\mathbb R\times(0,T)$, we consider the functional cost  to be minimized $J$, over a suitable class of initial data $\mathcal{U}_{ad}$, defined by</p>

<script type="math/tex; mode=display">\begin{equation}\label{FunctionalJ}
J(u^0)=\frac 1 2\int_0^T\int_{\mathbb{R}}\rho(x,t)|u(x,t)-u^d(x,t)|^2dxdt,
\end{equation}</script>

<p>where  $u:\mathbb R_x\times\mathbb R_t\to \mathbb R$ is the unique entropy solution of the scalar conservation law</p>

<script type="math/tex; mode=display">\begin{equation}\label{conservativeEquation}
\partial_t u+\partial_x(f(u))=0,\; \textrm{in }\mathbb R \times(0,T); \;\;\; u(x,0)=u^0(x),\; x\in\mathbb R.
\end{equation}</script>

<p>Thus, the problem under consideration reads: To find $u^{0,min}\in\mathcal{U}_{ad}$ such that</p>

<script type="math/tex; mode=display">\begin{equation}\label{optimalProblem}
J(u^{0,min})=\min_{u^0\in\mathcal{U}_{ab}}J(u^0).
\end{equation}</script>

<p>Here the flux $f:\mathbb R\to\mathbb R$ is assumed to be  smooth:  $f\in C^1(\mathbb R,\mathbb R)$. The initial datum $u^0$ will be assumed to belong to a suitable admissible class $\mathcal{U}_{ad}$ to ensure the existence of a minimizer.</p>
<h5>Sensitivity of the state in the presence of shocks</h5>
<p>Inspired in several results on the sensitivity of  solutions of conservation laws in the presence of shocks in one-dimension  (see [<a href="#BressanMarson1995">7</a>, <a href="#BardosPironneau2002">4</a>, <a href="#BouchutJames1998">5</a>, <a href="#BouchutJames1999">6</a>, <a href="#Ulbrich2003">17</a>, <a href="#GodlewskiRaviart1999">13</a>]), we focus on the particular case of solutions having a single shock. But the analysis can be extended to consider more general one-dimensional systems of conservation laws with a finite number of noninteracting shocks. We introduce the following hypothesis:</p>

<p><strong>Hypothesis 1.1:</strong>
<i>Assume that $u(x,t)$ is a weak entropy solution of (\ref{conservativeEquation}) with a discontinuity along a regular curve $\Sigma={(\varphi(t),t),\;t\in(0,T)}$, which is Lipschitz continuous outside $\Sigma$. In particular, it satisfies the Rankine-Hugoniot condition on $\Sigma$</i></p>

<script type="math/tex; mode=display">\varphi'(t)[u]_{\Sigma^t}=[f(u)]_{\Sigma^t}.</script>

<p><i>Here we have used the notation: </i></p>

<script type="math/tex; mode=display">[v]_{\Sigma^t}=\lim\limits_{\varepsilon\searrow 0}v(\varphi(t)+\varepsilon,t) -v(\varphi(t)-\varepsilon,t)</script>

<p><i>for the jump at $\Sigma^t=(\varphi(t),t)$ of any piecewise continuous function $v$ with a discontinuity at $\Sigma^t$.
</i></p>

<p>Note that $\Sigma$ divides $\mathbb R \times (0, T )$ into two parts: $Q_-$ and $Q_+$ , the sub-domains of $\mathbb R \times (0, T)$ to the left and to the right of $\Sigma$ respectively.
As we will see, in the presence of shocks, to deal correctly with optimal control and design problems, the state of the system needs to be viewed as constituted by the pair $(u,\varphi)$ combining the solution of (\ref{conservativeEquation}) and the shock location $\varphi$. This is relevant in the analysis of sensitivity of functions below and when applying descent algorithms.
We adopt the functional framework based on the generalized tangent vectors (see [<a href="#BressanMarson1995">7</a>] and Definition 4.1 in [<a href="#castro2008alternating">8</a>]).
Let $u^0$ be the initial datum,  that we assume to be Lipschitz continuous to both sides of a single discontinuity located at $x = \varphi^0$, and consider a generalized tangent vector $(\delta u^0,\delta \varphi^0) \in L^1(\mathbb R) \times \mathbb R$ for all $0 \leq T$. Let $u^{0,\varepsilon}$ be a path which generates $(\delta u^0,\delta \varphi^0)$. For $\varepsilon$ sufficiently small, the solution $u^\varepsilon(\cdot,t)$ of (\ref{conservativeEquation}) is Lipschitz continuous with a single discontinuity at $x = \varphi^{\varepsilon}(t)$, for all $t \in [0,T]$. Therefore, $u^{\varepsilon}(\cdot, t)$ generates a generalized tangent vector $(\delta u(, t), \delta\varphi(t)) \in L^1(\mathbb R) \times \mathbb R$. Moreover, in [<a href="#castro2008alternating">8</a>] it is proved that it satisfies the following linearized system:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray}
\label{1DlinearizedSystem01}
\partial_t \delta u+\partial_x(f'(u)\delta u)&=&0,\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\text{in } Q_-\cup Q_+\\
\label{1DlinearizedSystem03}
\frac{d}{dt}\left([u]_{\Sigma^t}\delta\varphi\right)&=&[f'(u)\delta u]_{\Sigma^t}-[\delta u]_{\Sigma^t}\frac{d}{dt}\varphi,\;\; t\in(0,T)\\
\label{1DlinearizedSystem02}
\delta u(x,0)&=&\delta u^0(x),\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\{x<\varphi^0\}\cup\{x>\varphi^0\}\\
\label{1DlinearizedSystem04}
\delta\varphi(0)&=&\delta\varphi^0.
\end{eqnarray} %]]></script>

<h5>Sensitivity of the cost in the presence of shocks</h5>
<p>In this section we study  the sensitivity of the functional $J$ with respect to variations associated with the generalized tangent vectors defined in the previous section. We first define an appropriate generalization of the Gateaux derivative of $J$.</p>

<p><strong>Definition 1.2:</strong> <i>Let $J : L^1(\mathbb R) \to \mathbb R$ be a functional and $u^0 \in L^1(\mathbb R)$ be Lipschitz continuous with a discontinuity in  $\Sigma^0$, an initial datum for which the solution of (\ref{conservativeEquation}) satisfies hypothesis (1.1). $J$ is Gateaux differentiable at $u^0$ in a generalized sense if for any generalized tangent vector $(\delta u^0,\delta \varphi^0)$ and any family $u^{0,\varepsilon}$	associated to $(\delta u^0, \delta \varphi^0)$ the following limit exists,</i></p>

<script type="math/tex; mode=display">\delta J=\lim_{\varepsilon\to 0}\frac{J(u^{0,\varepsilon})-J(u^0)}{\varepsilon},</script>

<p>and it depends only on $(u^0,\varphi^0)$ and $(\delta u^0,\delta\varphi^0)$, i.e. it does not depend on the particular family $u^{0,\varepsilon}$ which generates $(\delta u^0,\delta\varphi^0)$. The limit is the generalized Gateux derivative of $J$ in the direction $(\delta u^0,\delta\varphi^0)$.
&lt;/i&gt;</p>

<p>The following result easily provides a characterization of the generalized Gateaux derivative of $J$ in terms of the solution of the associated adjoint system (\ref{1DSystemAdj}).</p>

<p><strong>Proposition 1.3:</strong> <em>The Gateaux derivative of $J$ can be written as follows</em></p>

<script type="math/tex; mode=display">\begin{equation}
\label{GateauxDerivativeJ02}
\delta J(u^0)[\delta u^0,\delta\varphi^0]=\int_{\RR}p(x,0)\delta u^0(x) dx-q(0)[u]_{\Sigma^0}\delta\varphi^0,
\end{equation}</script>

<p>where the adjoint state pair $(p,q)$ satisfies the system</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray}
\label{1DSystemAdj}
-\partial_t p-f'(u)\partial_x p&=&\rho\,(u-u^d),\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; \text{in } Q_-\cup Q_+\\  
\,[p]_{\Sigma^t}&=&0,\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; t\in(0,T) \label{1Dadjoint0202}\\
q(t)&=&p(\varphi(t),t),\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\; t\in (0,T)\label{1Dadjoint0203}\\
-\frac{d}{dt}q&=&\frac{(1+(\dot{\varphi})^2)^{1/2}[\rho\,(u-u^d)^2]_{\Sigma^t}}{2[u]_{\Sigma^t}},\;\;\;\;\;\;\;\;\; t\in (0,T) \label{1Dadjoint03} \\
p(x,T)&=&0,\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;\{x<\varphi(T)\}\cup\{x>\varphi(T)\} \label{1Dadjoint02}\\
q(T)&=&0. \label{1Dadjoint04}
\end{eqnarray} %]]></script>

<p>Let us briefly comment the result of Proposition 1.3 before giving its proof.
System (\ref{1DSystemAdj}) has a unique solution. In fact, to solve the backward system (\ref{1DSystemAdj}) we first define the solution $q$ on the shock $\Sigma$ from the conditions for $q$. This determines the value of $p$ along the shock. We then propagate this information to both sides of $\Sigma$, by characteristics (see Figure 1 where we illustrate this construction).</p>

<p><img src="https://cmc.deusto.eus/wp-content/uploads/2017/05/ConservationLawsShocksFig1.jpg" alt="Characteristic lines entering on a shock" width="600" /> Figure 1: Characteristic lines entering on a shock and how they may be used to build the solution of the adjoint system both away from the shock and on its region of influence.</p>

<p>Formula (\ref{GateauxDerivativeJ02}) provides an obvious way to compute a first descent direction of $J$ at $u^0$. We just take</p>

<script type="math/tex; mode=display">\begin{equation}\label{descentDirection01}
(\delta u^0,\delta \varphi^0)=(-p(\cdot,0),q(0)[u]_{\Sigma^0}).
\end{equation}</script>

<p>Here, the value of $\delta \varphi^0$ must be interpreted as the optimal infinitesimal displacement of the discontinuity of $u^0$.</p>

<p>In [<a href="#castro2008alternating">8</a>], when considering the inverse design problem, it was observed that the solution $p$ of the corresponding adjoint system at $t=0$ was discontinuous, with two discontinuities, one in each side of the original location of the discontinuity at $\Sigma^0$. This was a reason not to use this descent direction and  for introducing the alternating descent method. In the present setting, however, the adjoint state $p$ obtained is typically continuous. This is due to the fact that $p$ at both side of the discontinuity is defined by the method of characteristics and that, on the region of influence of the characteristics emanating from the shock, the continuity is preserved by the fact that, on one hand, $q=q(t)$ itself is continuous as the primitive of an integrable function and that the data for $p$ and $q$ at $t=T$ are continuous too. Despite of this, as we shall see, the implementation of the alternating descent direction method is worth since it significantly improves the results obtained by the purely discrete approach.</p>

<h3>Numerical Experiments</h3>
<p>In this section we present some numerical experiments which illustrate the results obtained in an optimization model problem with each one of the numerical methods described in the previous section.
We have chosen as computational domain the interval $(-4, 4)$ and we have taken as boundary conditions in the numerical scheme, at each time step $t = t^n$, the value of the initial data at the boundary. This can be justified if we assume that the initial datum $u^0$ is constant in a sufficiently large inner neighborhood of the boundary $x = \pm 4$ (which depends on the size of the $L^\infty$-norm of the data under consideration and the time horizon $T$), due to the finite speed of propagation. A similar procedure is employed for the adjoint equation.
We underline once more that the solutions obtained with each method may correspond to global minima or local ones since the gradient algorithm does not distinguish them.
In the experiments we consider the Burgers’ equation, i.e. $f(z)=z^2/2$,</p>

<script type="math/tex; mode=display">\begin{equation}\label{BurgerNumerica}
\partial_tu+\partial_x\left(\frac{u^2}{2}\right)=0,\;\;\; u(x,0)=u^0(x).
\end{equation}</script>

<p>The weight function $\rho$, under consideration in the experiments is given by</p>

<script type="math/tex; mode=display">% <![CDATA[
\rho(x,t)=\left\{
\begin{array}{cl}
1 & t\in ( T/2,T)\\
0 & \text{otherwise.}
\end{array}
\right. %]]></script>

<p>And the  time horizon $T=1$.
To compare the efficiency of the different methods we consider a fixed $\Delta x = 1/20, \lambda = \Delta t /\Delta x = 2/3$ (which satisfies the CFL condition). We then analyze the number of  iterations that each method needs  to attain a prescribed value of the functional.</p>

<h5>Experiment 1</h5>
<p>We first consider a piecewise constant target profile $u^d$ given by the solution of \ref{BurgerNumerica} with the initial condition $(u^d)^0$ given by</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation}\label{E1u0minimoa}
(u^d)^0(x)=\left\{
\begin{array}{cl}
0.7 & x\in[-2,1]\\
0 & \text{otherwise.}
\end{array}
\right.
\end{equation} %]]></script>

<p>Note that, in this case,  \ref{E1u0minimoa} yields a particular solution of the optimization problem and the minimum value of $J$ vanishes.
We solve the optimization problem \ref{optimalProblem} with the above described different methods starting from the following initialization for $u^0$:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation}\label{Ep1u^0}
u^0(x)=\left\{
\begin{array}{cl}
0.5 & x\leq 0\\
-0.1 & x>0,
\end{array}
\right.
\end{equation} %]]></script>

<p>which also has a discontinuity but located on a different point.</p>

<p><img src="https://cmc.deusto.eus/wp-content/uploads/2017/06/ConservationLawsShocksFig2.jpg" alt="Characteristic lines entering on a shock" width="600" /> Figure 2: Experiment 1. $\log (J)$ versus the number of iterations in the descent algorithm for the discrete  and the alternating descent methods.</p>

<p>In Figures 3 and 4, we present the minimizers  obtained by the methods above, and the associated solutions, Figures 5 and 6.
The initial datum $u^0$ obtained by the alternating descent method (Figures 4) is a good  approximation of \ref{E1u0minimoa}. The solution given by  the discrete approach (Figure 3) presents added spurious oscillations. Furthermore, the discrete method is much slower and does not achieve the same level of accuracy since the functional $J_\Delta$ does not decrease so much.</p>

<p><img src="https://cmc.deusto.eus/wp-content/uploads/2017/06/ConservationLawsShocksFig3-6.jpg" alt="Experiment1 iterations and solutions" width="600" /> </p>

<h5>Experiment 2</h5>
<p>The previous experiment indicates that the alternating descent method performs significantly better. In order to show that this is a systematic fact, which arises independently of the initialization of the method, we consider the target $u^d$ given by the solution of \ref{BurgerNumerica} with the initial condition $(u^d)^0$ given by</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{equation}\label{E2u0minimo}
(u^d)^0(x)=\left\{
\begin{array}{cl}
0.5 & x\leq 0.5\\
0 & \text{otherwise,}
\end{array}
\right.
\end{equation} %]]></script>

<p>but this time we compare the performance of both methods starting from different initializations.
The obtained numerical results are presented in Figure 7.
We see that, regardless the initialization considered, the alternating descent method performs significantly better.
We observe that in the five experiments the alternating descent method perfumes better ensuring the descent of the functional in much fewer iterations and yielding smoother, less oscillatory approximation of the minimizer.
Note also  that the discrete method, rather than yielding discontinuous approximations of the minimizer as the alternating descent method does, it produces an initial datum with a Lipschitz front. Observe that these are  two different configurations that can lead to the same evolution for the Burgers equation after some time, once the front develops the discontinuity. This is in agreement with the fact that the functional to be minimized is only active in the time-interval $T/2 \le t \le T$.</p>

<p><img src="https://cmc.deusto.eus/wp-content/uploads/2017/06/ConservationLawsShocksFig7.jpg" alt="Experiment2 comparision results" width="800" /> </p>

<h3>Bibliography</h3>

<p><strong>[1]</strong> A. Adimurthi, S.S. Ghoshal and V. Gowda <a name="adimurthi:hal-00805317"><em>Optimal controllability for scalar conservation laws with convex flux.</em></a> 12, Jan. 2012.</p>

<p><strong>[2]</strong> D. Auroux and J. Blum <a name="AB" href="http://www.sciencedirect.com/science/article/pii/S1631073X05002074"><em>Back and forth nudging algorithm for data assimilation problems.</em></a> Comptes Rendus Mathematique, 340(12):873 – 878, 2005.</p>

<p><strong>[3]</strong> D. Auroux and M. Nodet <a name="AN" href="https://arxiv.org/abs/0809.4838"><em>The back and forth nudging algorithm for data assimilation problems: theoretical results on transport equations.</em></a> ESAIM: Control, Optimisation and Calculus of Variations, 18(2):318–342, 7 2012.</p>

<p><strong>[4]</strong> C. Bardos and O. Pironneau <a name="BardosPironneau2002" href="http://www.sciencedirect.com/science/article/pii/S1631073X02025748"><em>A formalism for the differentiation of conservation laws.</em></a> C. R. Math. Acad. Sci. Paris, 335(10):839–845, 2002.</p>

<p><strong>[5]</strong> F. Bouchut and F. James <a name="BouchutJames1998" href="http://www.sciencedirect.com/science/article/pii/S1631073X02025748"><em>One-dimensional transport equations with discontinuous coefficients.</em></a> Nonlinear Anal., 32(7):891–933, 1998.</p>

<p><strong>[6]</strong> F. Bouchut and F. James <a name="BouchutJames1999" href="https://link.springer.com/chapter/10.1007/978-3-0348-8720-5_13"><em>Differentiability with respect to initial data for a scalar conservation law.</em></a> In Hyperbolic problems: theory, numerics, applications, Vol. I (Zürich, 1998), volume 129 of Internat. Ser. Numer.Math., pages 113–118. Birkhäuser, Basel, 1999.</p>

<p><strong>[7]</strong> A. Bressan and A. Marson <a name="BressanMarson1995" href="https://www.math.psu.edu/bressan/PSPDF/hyp-varcalculus.pdf"><em>A variational calculus for discontinuous solutions of systems of conservation laws.</em></a> Comm. Partial Differential Equations, 20(9-10):1491–1552, 1995.</p>

<p><strong>[8]</strong> C. Castro, F. Palacios and E. Zuazua <a name="castro2008alternating" href="https://www.newton.ac.uk/files/preprints/ni07040_0.pdf"><em> An alternating descent method for the optimal control of the inviscid burgers equation in the presence of shocks.</em></a> Mathematical Models and Methods in Applied Sciences, 18(03):369–416, 2008</p>

<p><strong>[9]</strong> C. Castro, F. Palacios and E. Zuazua <a name="Castro2010" href="http://adl.stanford.edu/papers/Integral_Methods_2010.pdf"><em> Optimal control and vanishing viscosity for the burgers equation.</em></a> Integral Methods in Science and Engineering, Volume 2, pages 65–90.Birkhäuser Boston, 2010.</p>

<p><strong>[10]</strong> C. Castro and E. Zuazua <a name="MR2813348" href="http://paginaspersonales.deusto.es/enrique.zuazua/documentos_public/archivos/publicaciones/fluxidrev.pdf"><em> Flux identification for 1-d scalar conservation laws in the presence of shocks.</em></a> Math. Comp., 80(276):2025–2070, 2011</p>

<p><strong>[11]</strong> S. Garreau, P. Guillaume and M. Masmoudi. <a name="Garreau:2000:TAP:587448.587670" href="http://epubs.siam.org/doi/abs/10.1137/S0363012900369538"><em>The topological asymptotic for pde systems: The elasticity case.</em></a> SIAM J. Control Optim., 39(6):1756–1778, Dec. 2000.</p>

<p><strong>[12]</strong> E. Godlewski and P. Raviart <a name="BookE.GodlewskiRaviart" href="https://books.google.es/books/about/Hyperbolic_systems_of_conservation_laws.html?id=hzvvAAAAMAAJ&amp;redir_esc=y"><em>Hyperbolic systems of conservation laws, Mathématiques and Applications</em></a> Ellipses, Paris, 1991.</p>

<p><strong>[13]</strong> E. Godlewski and P. Raviart <a name="GodlewskiRaviart1999"><em>The linearized stability of solutions of nonlinear hyperbolic systems of conservation laws. A general numerical approach.</em></a> Math. Comput. Simulation, 50(1-4):77–95, 1999. Modelling ’98 (Prague)</p>

<p><strong>[14]</strong> L. Gosse and F. James <a name="2000GosseJames" href="http://www.ams.org/journals/mcom/2000-69-231/S0025-5718-00-01185-6/"><em>Numerical approximations of one-dimensional linear conservation equations with discontinuous coefficients.</em></a> Mathematics of Computation, 69(231):pp. 987–1015, 2000.</p>

<p><strong>[15]</strong> S. N. Kružkov <a name="kruzkov" href="http://iopscience.iop.org/article/10.1070/SM1970v010n02ABEH002156/meta"><em>First order quasilinear equations with several independent variables.</em></a> Mat. Sb. (N.S.), 81 (123):228–255, 1970.</p>

<p><strong>[16]</strong> R. Lecaros and E. Zuazua <a name="RLEZ2014" href="http://www.ams.org/journals/mcom/2016-85-299/S0025-5718-2015-03015-4/"><em>Control of 2D scalar conservation laws in the presence of shocks.</em></a> Math. Comp. 85 (2016), 1183-1224</p>

<p><strong>[17]</strong> S. Ulbrich <a name="Ulbrich2003" href="http://www.sciencedirect.com/science/article/pii/S016769110200275X"><em>Adjoint-based derivative computations for the optimal control of discontinuous solutions of hyperbolic conservation laws.</em></a> Systems Control Lett., 48(3-4):313–328, 2003. Optimization and control of distributed systems.</p>

<p><strong>[18]</strong> X. Wen and S. Jin <a name="MR2378582" href="http://www.global-sci.org/jcm/freedownload/v26_1.pdf"><em>Convergence of an immersed interface upwind scheme for linear advection equations with piecewise constant coefficients I: $L^1$-error estimates.</em></a> J. Comput. Math., 26(1):1–22, 2008.</p>

        <hr>
      </div>
    </div>
  </div>
  <div id="content" class="container">

  <div class="relatedPosts">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
    <h2>Related Posts</h2>
    
    
    
    
    

    
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0010/ico.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp04/P0010" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Inverse problem for Hamilton-Jacobi equations </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this tutorial we study the inverse design problem for time-evolution Hamilton-Jacobi equations. More precisely, for a given observation of the viscosity solution at time $T>0$, we construct all the possible initial data that could have led the solution to the observed state. We note that these initial data are not in general unique. 
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/CarlosE">Carlos Esteve</a>
          
          - 03 April 2020
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0009/ico.png">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp04/P0009" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> POD and DMD Reduced Order Models for a 2D Burgers Equation </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      A short python implementation of POD and DMD for a 2D Burgers equation using FEniCS and Scipy
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Authors:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/JanH">Jan Heiland</a>,
          
          - 07 March 2020
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn btn-secondary btn-sm" style="margin-left: auto;">python</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0008/bilbao_LW_4.jpg">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp04/P0008" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> An eulerian-lagrangian scheme for the problem of the inverse design of hyperbolic transport equations </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      The inverse design of hyperbolic transport equations can be addressed by using gradient-adjoint methodologies. Recently, Morales-Hernandez and Zuazua [1] investigated the convenience of using low order numerical schemes for the adjoint resolution in the gradient-adjoint method. They focused on hyperbolic transport scalar equations with an heterogeneous time-independent vector field.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Authors:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/AlexandreS">Alexandre Francisco</a>,
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/UmbertoB">Umberto Biccari</a>,
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/EnriqueZ">Enrique Zuazua</a>
          
          - 18 February 2020
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP04/P0006/Projection2.png">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp04/P0006" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Inverse design for the one-dimensional Burgers equation </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      Our aim is to study an optimal control problem  which consists in minimizing the difference between the predictions of the Burgers equation  and the observations of the system at a final time  in $L^2(\mathbb{R})$ norm.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Authors:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/ThibaultL">Liard Thibault</a>,
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/EnriqueZ">Enrique Zuazua</a>
          
          - 12 December 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
            
    </div>
  </div> 
    </div>
  </div>

</article>
<hr>

    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <ul class="list-inline text-center">
        <li style="margin-right: 50px;">
          <img style="width: 250px;" src="/DyCon-Blog/img/logos/logo_DyCon.png " alt="">
        </li>
        <li style="padding-bottom: 5px;">
          <img style="width: 230px;" src="/DyCon-Blog/img/logos/logo_CCM_subDerecha_v002.png " alt="">
        </li>
      </ul>
    </div>
  </div>
</footer>

</body>
</html>
