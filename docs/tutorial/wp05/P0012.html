<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Welcome to the web interface of DyCon Toolbox, the computational platform developed within the <a href='https://cmc.deusto.eus/dycon/' target='_blank'>ERC DyCon - Dynamic Control</a> project.">
	<link rel='shortcut icon' type='image/png' href='/DyCon-Blog/favicon.png' />

  <title>
    Numerical simulation of nonlinear Population Dynamics Structuring by age and Spatial diffusion - DyCon Blog
    
  </title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link rel="canonical" href="https://deustotech.github.io/DyCon-Blog/tutorial/wp05/P0012">

  <!-- Bootstrap Core CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/bootstrap.min.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/clean-blog.css">

   <!-- Adjust Colors -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/colorscheme.css">

  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/syntax.css">

  <link rel="stylesheet" href="https://deustotech.github.io/DyCon-Blog/css/google-search.css">


  
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/libgif.js "></script>
  <script src="https://deustotech.github.io/DyCon-Blog/lib/js/rubbable.js "></script>


  <!-- Google Fonts Raleway -->
  <link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
	<!-- MathJax -->
  <script type="text/x-mathjax-config">
	MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
		TeX: {
      equationNumbers: {
        autoNumber: "AMS"
      },
      extensions: ["AMSmath.js", "AMSsymbols.js"],
      Macros:{
        norm: ["|| #1 ||",1],
        abs: ["| #1 |",1],
        hdots: "...",
        RR: "\\mathbb{R}",
        ffl: ["(d_x^2)^{#1}",1],
        ccs: "c_{1,s}",
        kernel: ["|x-y|^{#1}",1],
        ue: ["#1^{\\epsilon}",1]
      }
    },
    CommonHTML: {
      styles: {
        "@font-face /* vec */ ": {
          "font-family": "MJX-VEC",
          src: [
            "url(data:application/x-font-woff;charset=utf-8;base64,",
            "d09GRgABAAAAAARMAA0AAAAABiQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAEMAAAABwA",
            "AAAccRGLqUdERUYAAAQMAAAAJAAAACgANAAmT1MvMgAAAaAAAABJAAAAYFc5gfFjbWFwAAACAAAA",
            "AEYAAAFKQxjlbWdhc3AAAAQEAAAACAAAAAj//wADZ2x5ZgAAAlQAAACUAAAAlIQU9HBoZWFkAAAB",
            "MAAAADAAAAA2C748e2hoZWEAAAFgAAAAHgAAACQFXQDqaG10eAAAAewAAAAUAAAAFAYvAE9sb2Nh",
            "AAACSAAAAAwAAAAMACgAcm1heHAAAAGAAAAAHQAAACAASQAmbmFtZQAAAugAAADxAAAB5uwlD0hw",
            "b3N0AAAD3AAAACgAAAA34M9aEXjaY2BkYGAA4uOfgq7G89t8ZeBmfgEUYbga+icNTssClVxnOgXk",
            "cjAwgUQBdqEMW3jaY2BkYGBu+feBgYHxCwMQMF5nYGRABawAcaQESgAAeNpjYGRgYGBlUGZgYgAB",
            "EMnIABJzAPMZAAZZAHAAAAB42mNgYSxn/MLAysDA1MW0h4GBoQdCMz5gMGRkAooysDEzwAAjECvA",
            "OAFprikMBxgUFCcxt/z7wMDA3MIoAFUDAwoMjACD8Qv5AAAAAfQAMgAAAAABTQAAAPoAAAH0AB14",
            "2mNgYGBmgGAZBkYGEHAB8hjBfBYGDSDNBqQZGZgYFBQn/f8P5IPp/4/vFUHVAwEjGwOcw8gEJJgY",
            "UAEjxIrhDACLGwmnAAAAAAAUABQAFAAUAEoAAgAyAAABwgIVAAMABwAAMxEhESUhESEyAZD+ogEs",
            "/tQCFf3rMgGxAAEAHQIEAdcCygAiAAABNDYzMhcWFxYXFhUUBgcGBw4DIyImNTQ3IycmNTQ3ISYB",
            "eQsJBwUFBQofCwYLKyACBwMGBAcNL6urDQ0BZxgCtggMBQQPJRQHCwkGBhYpAgkCAgsJEygBCQoH",
            "DSYAeNqVjrGKwkAURe/EGBBUrG12CishMrFQcDuLsAi26YMOmsIMxAh+hN8i+CF+gd+y4B3zttjC",
            "woHhncu7774HoI8rFP5eIKzQw5dwgAjfwi2McBEO6bkLtzHAr3CEnhrTqcKOpDasMCQ1HKCLWLiF",
            "HyyFQ3puwm1oPIQjDFXfR62Ro8YeK9YzMlhsqB0qtvJ6v8rPmd3Uzkv2tihwwoHCbosTa0pryYH0",
            "NbKjRWPB/z626Se8dsY/hSHPGeTKOnXVzuqF/reYOoln8dQk80+u9b0KR97rD9Rc4xdNXtVQI7PV",
            "sXClNiaZGGP0B+FPMN1KMAAAAHjaY2BiAIP/zQxGDNgAKxAzMjAxMDMycSUWFeWXF2WmZ5QAAGh5",
            "BhgAAAAB//8AAnjaY2BkYGDgA2IJBgUgycTAyMDMwAIkWcA8BgZGCAYACgIAWwAAAAEAAAAAxmW3",
            "ygAAAADVVeemAAAAANVV7Dg=) format('woff')"
          ].join('')
        },
        ".MJX-VEC": {
          "font-family": "MJX-VEC"
        }
      }
    }
  });
  MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready", function () {
    var MML = MathJax.ElementJax.mml;
    var fixCombiningChar = MML.mo.prototype.CHTMLfixCombiningChar;
    MML.mo.Augment({
      CHTMLfixCombiningChar: function (node) {
        if (node.textContent === '\u20D7') {
          //
          //  Safari makes combining characters into non-combining ones when
          //  they don't have anything to combine with; replace \vec arrow
          //  with a non-combining one so all browsers get the same thing
          //
          node = node.firstChild;
          node.firstChild.nodeValue = "\u2192";
          node.className = "mjx-char MJX-VEC";
          node.style.marginLeft = "-.5em";
          node.style.paddingTop = ".45em";
        } else {
          fixCombiningChar.call(this,node);
        }
      }
    });
  });
	</script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
	<!--<script src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js" type="text/javascript"></script>-->

    <!-- jQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Custom Theme JavaScript -->
  <script src="https://deustotech.github.io/DyCon-Blog/js/clean-blog.min.js "></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-128123935-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-128123935-3');
  </script>
  <!-- End Google Analytics -->



  <!-- marKdown editor -->

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.css">
  <script src="https://cdn.jsdelivr.net/simplemde/latest/simplemde.min.js"></script>
</head>

<body>
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <!-- <a class="navbar-brand" href="/DyCon-Blog/">
                 <img src="https://deustotech.github.io//DyCon-Blog//assets/logo_DyCon.png">
            </a> -->
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/DyCon-Blog/">Home</a>
                </li>
                
                
                    
                        
                    
                                   
                <li>
                    <a href="/DyCon-Blog/projects/posts">Documentation</a>
                </li>
                
                    
                
                    
                <li>
                        <a href="https://deustotech.github.io/DyCon-Blog/projects/search.byWP">Sitemap</a>
                </li>
                <li>
                        <a href="http://cmc.deusto.eus/">Chair of Computational Mathematics</a>
                </li>
                
            </ul>

        
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Post Header -->
<header class="intro-header">
  <div class="container" style="padding-top: 70px;">
    <div class="row">
      <div class="col-lg-10 col-md-10 col-md-offset-1">
        <div class="post-heading" style="padding: 0px 0"><h2><small class="light-grey"><a href="https://deustotech.github.io//DyCon-Blog/projects/posts">Work Packages</a>
            &#8827;<a href="https://deustotech.github.io//DyCon-Blog/workpackage/WP05">
            Models involving memory terms and hybrid PDE+ODE systems</a> &#8827;</small>
          </h2>
          <h1>Numerical simulation of nonlinear Population Dynamics Structuring by age and Spatial diffusion</h1>
					<p class="meta">
            <div class="post-preview-authors ellipsis-one-line">
              Author:
              
              
                
                <span style="text-decoration: none;" itemprop="author" itemscope itemtype="http://schema.org/Person">
                  <span itemprop="name">
                    <a style="text-decoration: none;" href="https://deustotech.github.io/DyCon-Blog/author/YacoubaS">Yacouba Simpore</a>
                  </span>
                </span>
              
              - 30 October 2019
            </div>
					</p>
        </div>
      </div>
		</div>
	</div>
</header>
<!-- Post Content -->
<style>
img {
	display:block;
	max-width:  100%;
	margin-left: auto;
	margin-right: auto;
}

@media only screen and (min-width: 1000px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.2); 
	-webkit-transform:scale(1.2);
	-o-transform:scale(1.2);
}
}

@media only screen and (min-width: 1250px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(1.5); 
	-webkit-transform:scale(1.5);
	-o-transform:scale(1.5);
}
}

@media only screen and (min-width: 1500px) {
img {
	-moz-transition:-moz-transform 0.5s ease-in; 
	-webkit-transition:-webkit-transform 0.5s ease-in; 
	-o-transition:-o-transform 0.5s ease-in;
}
img:active{
	-moz-transform:scale(2); 
	-webkit-transform:scale(2);
	-o-transform:scale(2);
}
}
</style>
<article>
  <div id="content" class="container">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
        
          
            <a href="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/P0012-PopulationDynamics.zip""><i class="fa fa-download fa-lg"></i>Download Code</a>
          
        
        <p>In this tutorial, we propose the Hum method to approximate numerically the control in a null controllability problem for a non linear population dynamics model structuring in age and spatial diffusion.</p>

<p>For given the positive function $F$, we consider the following Population Dynamics Model Structuring by age and spatial diffusion:</p>

<script type="math/tex; mode=display">% <![CDATA[
(1):\left\{ 
\begin{array}{ccc}
\partial_{t} y+\partial_{a}y-Δ y+\mu y&=\chi_{\Theta}V&\text{ in }\Omega\times(0,A)\times (0,T) ,\\ 
\dfrac{\partial y}{\partial \nu}&=0& \partial \Omega \times (0,A)\times (0,T)\\
y\left( x,0,t\right) &=F\left(\int_{0}^{A}\beta(a)yda\right) &\text{ in }  \Omega\times(0,T) \\
y\left(x,a,0\right)&=y_{0}&
\text{ in } \Omega\times(0,A).
\end{array}
\right. %]]></script>

<p>where, $\Omega$ is a boundary subset of $\mathbb{R}^{N}$, $A$ is the maximal age and $T&gt;0$ the final time. Also, $\Theta=\omega× (a_1,a_2)× (0,T),$ is the control support. Here, $\beta$ is the fertility rate depending also the age a, $\mu$ the mortality rate depending of the age a, $y_0$ the initial condition in $L^2(\Omega× (0,A)),$ $V$ is the control term and $y$ represent the density of the population of age $a$ at time $t$ and location $x∈ \Omega.$</p>

<p>We assume that the fertility rate $\beta$ and the mortality rate $\mu$ satisfy the demographic property:</p>

<script type="math/tex; mode=display">(H_1)=
\left\{
\begin{array}{c}
\mu(a)\geq 0 \text{ for every } a\in (0,A)\\
\mu\in L^{1}_{loc}(0,A)\quad \int_{0}^{A}\mu(a)da=+\infty
\end{array} \right.,</script>

<p>and</p>

<script type="math/tex; mode=display">(H_2)=\left\{
\begin{array}{ccc}
\beta(a)\geq 0\quad a.e \quad (0,A)\\
\beta(a)\in C^{1}([0,A])\\
	\beta(a)=0 \text{ } \forall a\in (0,\hat{a}) \text{ where } \hat{a}\in (0,A), \\
\end{array}
\right.</script>

<p>where</p>

<script type="math/tex; mode=display">% <![CDATA[
0≤ a_1<a_2≤ A \text{ and }  a_1≤ \hat{a}. %]]></script>

<p>The function $F,$ verify:</p>

<script type="math/tex; mode=display">(H_3)=
\left\{
\begin{array}{c}
F \quad \text{ positive, globally Lipchitz }\\
F(0)=0,\quad F \text{ continuous and differentiable in } 0.
\end{array} \right..</script>

<h1 id="numerical-simulations">Numerical Simulations</h1>

<p>In this part, the objective is to illustrate numerically the approximate null controllability of the nonlinear problem.</p>

<p>Indeed, we consider the following system:</p>

<script type="math/tex; mode=display">% <![CDATA[
(4):\left\{ 
\begin{array}{ccc}
\partial_{t} y+\partial_{a}y-\partial^{2}_{xx}y+\mu y&=\chi_{\Theta}V&\text{ in }(0,1)\times(0,A)\times (0,T) ,\\ 
y'(0)=y'(1)&=0& \text{ in } (0,A)\times (0,T)\\
y\left( x,0,t\right) &=F\left(\int_{0}^{A}\beta(a)yda\right) &\text{ in }  (0,1)\times(0,T) \\
y\left(x,a,0\right)&=y_{0}&
\text{ in } (0,1)\times(0,A).
\end{array}
\right. %]]></script>

<h3 id="discretization-and-simulation-of-uncontrolled-system">Discretization and simulation of uncontrolled system</h3>

<p>The idea in this part is to highlight the numerical simimulation of the nonlinear problem. The first parts is to reduce the PDE to the finite dimensional system of the form</p>

<script type="math/tex; mode=display">\dot{U_l}=A_lU_l+vectorF+BV,</script>

<p>where $A_l$ and $B$ are matrices, and</p>

<script type="math/tex; mode=display">\begin{pmatrix}
U_l(t) \\
V(t) \\
\end{pmatrix}</script>

<p>is the finite dimensional state and control vector. Here, VectorF is the contribution of the nonlinear part, which comes from births. So let’s consider the following system</p>

<script type="math/tex; mode=display">% <![CDATA[
(5):\left\{ 
\begin{array}{ccc}
\dfrac{\partial y}{\partial t}+\textbf{A}y+\mu y&=\chi_{\Theta}V&\text{ in }\Omega\times(0,A)\times (0,T) ,\\ 
\dfrac{\partial y}{\partial \nu}&=0& \partial \Omega \times (0,A)\times (0,T)\\
y\left( x,0,t\right) &=F\left(\int_{0}^{A}\beta(a)yda\right) &\text{ in }  \Omega\times(0,T) \\
y\left(x,a,0\right)&=y_{0}&
\text{ in } \Omega\times(0,A).
\end{array}
\right. %]]></script>

<p>where</p>

<script type="math/tex; mode=display">\textbf{A}y=\partial_{a}y-\partial^{2}_{xx}y.</script>

<p>To solve $(4)$, the space (dimension 1) and age discretization is performed with finite difference method on rectangular grid 
on $[0,L]\times [0,A]$. For a given rectangular grid $\mathcal{T}$ with vertex $(x_i,a_j)\quad 1\leq i\leq N,\quad 1\leq j\leq M$ and uniform step size (without loss of generality) $\Delta x$ in $x-$direction and $\Delta a$ in $a-$direction, we denote by  the diameter of the grid
The finite difference approximation of the diffusion term of the operator $\textbf{A}$ is given by</p>

<script type="math/tex; mode=display">\dfrac{\partial^2 y}{\partial x^2}(x_i,a_j,t)=\dfrac{y(x_{i+1},a_j,t)-2y(x_i,a_j,t)+y(x_{i-1},a_j,t)}{(\Delta x)^2}.</script>

<p>The finite difference approximation of the aging term of the operator A is given by</p>

<script type="math/tex; mode=display">\dfrac{\partial y}{\partial a}(x_i,a_j,t)=\dfrac{y(x_{i},a_{j},t)-y(x_i,a_{j-1},t)}{\Delta a}.</script>

<p>Let $y_{i,j}(t)$ be the approximation of $y(x_i,a_j)$ and</p>

<script type="math/tex; mode=display">U_{l}(t) = (y_{i,j}(t))_{1\leq i\leq N,\quad 1\leq j\leq M}</script>

<p>where $y_{i,j}$ is at the position $i+j*(N-1)$ and $A_l$ the matrix of the mortality approximation, the diffusion approximation and the aging approximation.</p>

<h3 id="take-into-account-the-newborns">Take into account the newborns</h3>

<p>We denote by $\beta(a),$ the fertility rate, the newborn is given by:</p>

<script type="math/tex; mode=display">y(x,0,t)=F\left(\int_{0}^{A}\beta(a)y(x,a,t)da\right).</script>

<p>We approximate $\int_{0}^{A}\beta(a)y(x,a,t)da$ by</p>

<script type="math/tex; mode=display">\int_{0}^{A}\beta(a)y(x,a,t)da=(A/n)\sum_{j=1}^{n-1}\beta(a_j)y(x,a_j,t)+\dfrac{\beta(0)y(x,0,t)+\beta(A)y(x,A,t)}{2}.</script>

<p>Then</p>

<script type="math/tex; mode=display">y_{i,0}=A/n\sum_{k=1}^{n-1}\beta(a_k)y(x_i,a_k,t)+\dfrac{\beta(0)y(x_i,0,t)+\beta(A)y(x_i,A,t)}{2}\text{ for } i=1:n.</script>

<p>But as</p>

<script type="math/tex; mode=display">\dfrac{\partial y_{i,1}(t)}{\partial a}=\dfrac{y_{i,1}(t)-y_{i,0}(t)}{\Delta a}\text{ } i=1:n,</script>

<p>then</p>

<script type="math/tex; mode=display">\dfrac{\partial y_{i,1}(t)}{\partial a}=\dfrac{-A/n\sum_{k=1}^{n-1}\beta(a_k)y_{i,k}(t)+y_{i,1}(t)+\dfrac{\beta(0)y(x_i,0,t)+\beta(A)y(x_i,A,t)}{2}}{\Delta a}\quad i=1:n,</script>

<p>We create also the nonlinear vectorF from the births. Indeed, if we denote by</p>

<script type="math/tex; mode=display">(N_l)_{1\leq i\leq n*n;\leq j\leq n*n}</script>

<p>the matrix of the births,</p>

<script type="math/tex; mode=display">P_l=N_lU_l\quad where\quad  \left(\dfrac{A\sum_{k=1}^{n-1}\beta(a_k)y_{i,k}(t)+\dfrac{\beta(0)y(x_i,0,t)+\beta(A)y(x_i,A,t)}{2}}{n\Delta a}\right)_{1\leq i\leq n}=\left(P_l\right)_{1\leq i\leq n}\text{ } and \text{ } 
\left(P_l\right)_{n+1\leq i\leq n*n}=0</script>

<p>and we define the vectorF by:</p>

<script type="math/tex; mode=display">vectorF=F(N_lU_l).</script>

<p>The corresponding discrete system is given for a continuous initial solution $y_0$ by</p>

<script type="math/tex; mode=display">\dfrac{dU_l}{dt}=A_lU_l+vectorF\quad y(0)=y_0(x,a)</script>

<h3 id="example-1">Example 1</h3>

<h4 id="simulation-of-the-uncontrolled-system">Simulation of the uncontrolled system:</h4>

<p>For the simulation, we take $L=1,\text{ } A=10\text{, }\Delta x=1/54\quad \Delta a= 5/54$ and $T=40$. Moreover $F(t)=t\Phi(t)$ a Globally Lipchitz function where</p>

<script type="math/tex; mode=display">\Phi(t)=0.75\exp(-t)</script>

<p>The fertility $\beta$ is given by:</p>

<script type="math/tex; mode=display">% <![CDATA[
\beta(a) = 
 \begin{cases}
0 & \text { if } a<A/18 \\
 \frac{\alpha(a-5/18)^{\gamma-1}e^{-(a-5/18)/v}}{v^{\gamma}\Gamma(\gamma)}
\text{ if } A/18\leq a\leq 17A/18\\
 0 &\text{ if } a>17A/18.
  \end{cases} %]]></script>

<p>here $v=1$, $\gamma=5$, $\alpha=7$ and the mortality rate $\mu$ by</p>

<script type="math/tex; mode=display">\mu(a)=\dfrac{1}{10(A-a)}</script>

<hr />

<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/uncontrolled stat1.mp4" width="80%" controls=""></video>
</center>

<center><strong>Video 1.</strong> Evolution of the state of the uncontrolled system between t=0 and t=30 </center>

<p>We observe in this video the growth (aging) of news borns over time. We also notice the high birth rate of this population.</p>

<h2 id="construction-of-the-control-and-numerical-simulation">Construction of the control and numerical simulation</h2>

<p>We construct the control problem, which consists in minimizing the functional and we choose the classical Hum functional and the control matrix $B=\chi_{\Theta}$ where $\Theta=(x_1,x_2)\times (a_1,a_2)\times (0,T),$ and we suppose that $U_T$ is the desired state:</p>

<script type="math/tex; mode=display">J_{\epsilon}(U_l,V_l)=\dfrac{1}{\epsilon}\int_{0}^{A}\int_{0}^{L}\left(U_l(x,a,T)-U_T\right)^2dxda+\int_{0}^{T}\int_{a_1}^{a_2}\int_{x_1}^{x_2}V_{l}^{2}dxdadt.</script>

<p>Here $U_T=0.$\
The approximate null controllability become the minimization of  the functional $J,$ where $(U_l,V_l)$ verify the following system</p>

<script type="math/tex; mode=display">\dfrac{dU_l}{dt}=A_lU_l+vectorF+BV_l\quad U_l(0)=(y_0(x_i,a_j))_{1\leq i\leq N,1\leq j\leq M}</script>

<p>In this part the fertility $\beta$ is given by:</p>

<script type="math/tex; mode=display">% <![CDATA[
\beta(a) = 
 \begin{cases}
0 & \text { if } a<A/5 \\
 \frac{\alpha(a-/8)^{\gamma-1}e^{-(a-/8)/v}}{v^{\gamma}\Gamma(\gamma)}
\text{ if } A/5\leq a\leq 4A/5\\
 0 &\text{ if } a> 4A/5,
  \end{cases} %]]></script>

<p>here $v=1$, $\gamma=5$, $\alpha=7$
 and</p>

<script type="math/tex; mode=display">\mu(a)=\dfrac{1}{15(A-a)}</script>

<p>and $VectorF=(P_lU_l).^2$.This means that we consider that $F(t)=t^2$ which is globally lipchizt on a compact which is our case.</p>

<p>The system becomes:</p>

<script type="math/tex; mode=display">\dfrac{dU_l}{dt}=A_lU_l+(P_lU_l).^2+BV_l\quad U_l(0)=(y_0(x_i,a_j))_{1\leq i\leq N,1\leq j\leq M}.</script>

<h3 id="example-2">Example 2</h3>

<p>In this example, we take $ε=0.05$, $\Delta x=0.05$ and $\Delta a= 0.5$, with the initial condition</p>

<script type="math/tex; mode=display">y_0(x,a)=e^{-(10(a-3/10)^2+70(x-4/10))}</script>

<p>the following numerical results were obtained for $T=12$ and $\Delta t=120$.</p>

<p>Evolution of the control V between t=0 and t=12.</p>
<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/example2stat.mp4" width="80%" controls=""></video>
</center>
<center><strong>Video 2.</strong> Evolution of the state of controlled system between t=0 and t=12 </center>

<p>We notice that, with a control domain that takes into account the most populated part of the domain, the Hum method applied to the Casadi algorithm gives us an interesting approximative controllability result while maintaining the positivity of the density.
Evolution of the controlled state (density of the population) between t=0 and t=12.</p>
<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/example2cont.mp4" width="80%" controls=""></video>
</center>

<center><strong>Video 3.</strong> Evolution of the control function between t=0 and t=12 </center>

<h3 id="example-3">Example 3</h3>

<p>Here, we keep the same parameters of the Example 1 but we change the final time (here T=20) , and we take $\Delta x=1/18$, $Δ a=5/18$, $\epsilon=0.05$ the following numerical results were obtained:</p>
<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/videofinalc.mp4" width="80%" controls=""></video>
</center>
<center><strong>Video 4.</strong> Evolution of the state of the controlled system between t=0 and t=20 </center>

<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/ccc.mp4" width="80%" controls=""></video>
</center>

<center><strong>Video 4.</strong> Evolution of the state of the controlled system between t=0 and t=20 </center>

<h3 id="example-4">Example 4</h3>

<p>In this part we consider a smaller control domain. Indeed we take 
$\Theta =(0,2/5)\times(0,4)\times(0,T)$. 
In addition we also remove $\epsilon=0.001$ and $T=20.$ The rest is identical to the data of example 2.</p>

<p>We obtain the following numerical results:</p>

<p>Evolution of the control V between t=0 and t=20.</p>

<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/example4stat.mp4" width="80%" controls=""></video>
</center>

<center><strong>Video 4.</strong> Evolution of the state of the controlled system between t=0 and t=20 </center>

<p>Here although the result is acceptable, we notice that the state of the controlled system is negative for most of the time.\
Evolution of the controlled state (the density of the population) between t=0 and t=20.</p>

<center>
<video src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0012/example4cont.mp4" width="80%" controls=""></video>
</center>

<center><strong>Video 5.</strong> Evolution of the control function between t=0 and t=20 </center>
<p>We notice here that the solution to the final time tends to 0, but during the time of control much of the state of the system was negative.
We notice that numerically we have approximation and the positivity of the state, if the support of the control covers the most populated part of the domain (space, age).</p>

<p>However it should be noted that we could not take a positivity constraint in our simulations. It should be noted that we have better approximations when we do not consider the cost of control.</p>

<h2 id="references">References</h2>
<p>[1] Dycon Toolbox</p>

<p>[2] CasaDi toolbox</p>

<p>[3] Luca Gerardo-Giorda: NUMERICAL APPROXIMATION OF DENSITY DEPENDENT DIFFUSION IN AGE-STRUCTURED POPULATION DYNAMICS</p>

        <hr>
      </div>
    </div>
  </div>
  <div id="content" class="container">

  <div class="relatedPosts">
    <div class="row">
      <div class="col-md-10 col-md-offset-1">
    <h2>Related Posts</h2>
    
    
    
    
    

    
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0011/icon.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp05/P0011" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Moving control strategy for memory-type equations </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      Numerical implementation of the moving control strategy for a two dimensional heat equation with memory
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Authors:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/JesusO">Jesus Oroya</a>,
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/UmbertoB">Umberto Biccari</a>
          
          - 20 October 2020
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0014/twiterFractional.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp05/P0014" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Simulation of Fractional Heat Equation </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this tutorial, we show the simulation of heat fractional equation
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/UmbertoB">Umberto Biccari</a>
          
          - 01 February 2020
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-success btn-sm" style="margin-left: auto;">DyCon Toolbox</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0013/avatar.gif">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp05/P0013" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Optimal Control of the Fokker-Planck Equation with CasADi </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this tutorial, we present an optimal control problem related to the Fokker-Planck equation.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/JorgeM">Jorge Mallo</a>
          
          - 19 December 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-danger btn-sm" style="margin-left: auto;">MATLAB-CasADi</button>
    
    </div>

  </div>
</div>


          </div>
          
          
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
    
      
    
        
        
    
        
    
        
          <div>
          
            <div class="post-preview shadowbox">
  <div class="post-avatar-wp">
  
    <img src="https://deustotech.github.io/DyCon-Blog/assets/imgs/WP05/P0010/Fig06.jpg">
  
  </div>
  <div class="post-info">
    <a href="/DyCon-Blog/tutorial/wp05/P0010" class="display-block">
      <h4 class="post-preview-title ellipsis-two-lines"> Controllability of a Class of Infinite Dimensional Systems with Age Structure </h4>
    </a>

    <div class="post-preview-subtitle ellipsis-two-lines">
      In this tutorial,  we investigate the linear infinite dimensional system obtained by implementing an age structure to a given  linear dynamical system. We show that if the initial system is null controllable in a time small enough, then the age structured system is also null controllable in a time depending on the various involved parameters.
    </div>

    <div style="display: flex;margin-top: 10px;">
        <div class="post-preview-authors ellipsis-one-line">
          Author:
          
          
            
              <a href="https://deustotech.github.io/DyCon-Blog/author/DebayanM">Debayan Maity</a>
          
          - 07 June 2019
        </div>
        
        <button onclick="window.location.href='https://deustotech.github.io/DyCon-Blog/projects/search.bycode'" type="button" class="btn btn-primary btn-sm" style="margin-left: auto;">MATLAB</button>
    
    </div>

  </div>
</div>


          </div>
          
          
            
    </div>
  </div> 
    </div>
  </div>

</article>
<hr>

    <!-- Footer -->
<footer>
  <hr>
  <div class="container">
    <div class="row">
      <ul class="list-inline text-center">
        <li style="margin-right: 50px;">
          <img style="width: 250px;" src="/DyCon-Blog/img/logos/logo_DyCon.png " alt="">
        </li>
        <li style="padding-bottom: 5px;">
          <img style="width: 230px;" src="/DyCon-Blog/img/logos/logo_CCM_subDerecha_v002.png " alt="">
        </li>
      </ul>
    </div>
  </div>
</footer>

</body>
</html>
