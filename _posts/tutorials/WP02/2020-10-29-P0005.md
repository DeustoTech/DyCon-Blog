---
title: ResNet stabilzation in MNIST dataset
author: [JesusO,BorjanG]
date: 2020-10-29
description: 
layout: pretutorial
categories: [tutorial,WP02]
code: MATLAB
equation: LINEAL
avatar: 
url_zip: /assets/imgs/WP02/P0005/MNISTRESNET.zip

noshow: true
---

<!-- Consideraremos el problema de clasificación MNIST -->

Consideramos el problema de clasificación MNIST. Este problema tiene  datos de entrada tal que $x \in \mathcal{M}_{28 \times 28}(\mathbb{R})$ y datos de salida  tal que $y \in  \mathbb{R}^{10}$. Los elementos de la base canónica de $\mathbb{R}^{10}$ representa el conjunto de dígitos $ \\{0,1,2,\dots,8,9 \\}$.

<img src="{{site.url}}/{{site.baseurl}}/assets/imgs/WP02/P0005/ex.png" width="70%">
<center>figura 1. Distintos datos de entrada $x \in \mathcal{M}_{28 \times 28}(\mathbb{R})$ y datos de salida $y \in  \mathbb{R}^{10}$ en la parte superior de cada una.   </center>

Buscamos una función $f_{\Omega}: \mathcal{M}_{28 \times 28}(\mathbb{R}) \rightarrow \mathbb{R}^{10}$ que sea capaz de reproducir el comportamiento que vemos en los datos. Tomarémos como modelo una red ResNet

$$
\begin{equation}\label{sys}
y = \mathcal{P} z_T \\ 
z_T  \leftarrow \begin{cases}z_{t+1} = z_{t} + dt \ \sigma(A_t z_t+ b_t) & t \in \{1,2,\dots,T\} \\
z_0 = A_0 x
\end{cases}
\end{equation}
$$

- $\Omega = \\{ A_t,b_t\\}_{t=0}^T$
- Con $\\{z_t\\}_{t=1}^{N} \in \mathbb{R}^n \\ / \\ n < 28^2$. 
- La primera matriz es distintas de las demás, $A_0 \in \mathcal{M}_{28^2 \times n}$
- Las siguientes matrices son cuadradas: $ \\{A_t\\}_{t=1}^{N} \in \mathcal{M}\_{n \times n} $
  
Plantemos el problema de control 

$$ 
\min_{\omega} \frac{1}{M}\sum_{m=1}^M\sum_{t=0}^T || \mathcal{P}z_t - y_m ||^2 + \beta || \Omega||^2
$$